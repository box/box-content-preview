language: node_js
node_js:
- '8'
stages:
- ci
- name: sauce-labs
  if: type = cron
jobs:
  include:
  - stage: ci
    script: yarn run ci
    cache: yarn
  - stage: sauce-labs
    addons:
      sauce_connect: true
    before_script:
    - python -m SimpleHTTPServer &
    - sleep 5
    script: yarn run functional-tests-ci
    notifications:
      email:
        recipients:
          - preview-alerts@box.com
        on_success: never 
        on_failure: always
    cache: yarn
