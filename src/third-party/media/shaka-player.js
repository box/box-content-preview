(function(){var g={};
(function(window){var k,aa=this;function p(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.dc=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.cc=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function ba(){};function ca(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}ca("error");ca("warn");ca("info");ca("log");ca("debug");function da(a){ea[a]={na:fa(),end:NaN}}function ga(a){if(a=ea[a])a.end=fa()}function ha(a){return(a=ea[a])&&a.end?a.end-a.na:NaN}var fa=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,ea={};function ia(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}p("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function ja(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.minHeight=this.maxHeight=null}ja.prototype.clone=function(){var a=new ja;a.maxHeight=this.maxHeight;a.minHeight=this.minHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function r(){this.fontSize="100%";this.fontColor=ka;this.fontOpacity=la;this.backgroundColor=ma;this.backgroundOpacity=la;this.fontEdge=na}p("shaka.player.TextStyle",r);r.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};r.prototype.load=r.prototype.a;r.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
r.prototype.store=r.prototype.b;function oa(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+pa(a.fontColor,a.fontOpacity));b.push("background-color: "+pa(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(pa(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function pa(a,b){return"rgba("+a.concat(b).join(",")+")"}var ka=[255,255,255],ma=[0,0,0];
r.StandardColors={WHITE:ka,BLACK:ma,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var la=1;r.StandardOpacities={OPAQUE:la,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var na=[];
r.EdgeStyles={NONE:na,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function qa(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}p("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function ra(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function sa(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}p("shaka.player.VideoTrack.compare",sa);function ta(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=ua)}p("shaka.polyfill.CustomEvent.install",ta);function ua(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function wa(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
xa);document.addEventListener("webkitfullscreenerror",xa);document.addEventListener("mozfullscreenchange",xa);document.addEventListener("mozfullscreenerror",xa);document.addEventListener("MSFullscreenChange",xa);document.addEventListener("MSFullscreenError",xa)}p("shaka.polyfill.Fullscreen.install",wa);function xa(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function ya(){return Promise.reject(Error("The key system specified is not supported."))}function za(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Aa(){throw new TypeError("Illegal constructor.");}Aa.prototype.createSession=function(){};Aa.prototype.setServerCertificate=function(){};function Ba(){throw new TypeError("Illegal constructor.");}Ba.prototype.getConfiguration=function(){};Ba.prototype.createMediaKeys=function(){};function w(a){this.c=[];this.b=[];this.ba=Ca;if(a)try{a(this.W.bind(this),this.a.bind(this))}catch(b){this.a(b)}}var Ca=0;function Da(){window.Promise||(window.Promise=w,window.Promise.resolve=Ea,window.Promise.reject=Fa,window.Promise.all=Ga,window.Promise.race=Ha,Ja=window.setImmediate?function(a){window.setImmediate(a)}:function(a){window.setTimeout(a,0)})}p("shaka.polyfill.Promise.install",Da);function Ea(a){var b=new w;b.W(a);return b}function Fa(a){var b=new w;b.a(a);return b}
function Ga(a){function b(a,b,c){a.ba==Ca&&(e[b]=c,d++,d==e.length&&a.W(e))}var c=new w;if(!a.length)return c.W([]),c;for(var d=0,e=Array(a.length),f=c.a.bind(c),g=0;g<a.length;++g)a[g].then?a[g].then(b.bind(null,c,g),f):b(c,g,a[g]);return c}function Ha(a){for(var b=new w,c=b.W.bind(b),d=b.a.bind(b),e=0;e<a.length;++e)a[e].then?a[e].then(c,d):c(a[e]);return b}
w.prototype.then=function(a,b){var c=new w;switch(this.ba){case 1:Ka(this,c,a);break;case 2:Ka(this,c,b);break;case Ca:this.c.push({Ia:c,Ba:a}),this.b.push({Ia:c,Ba:b})}return c};w.prototype.then=w.prototype.then;w.prototype.catch=function(a){return this.then(void 0,a)};w.prototype["catch"]=w.prototype.catch;w.prototype.W=function(a){if(this.ba==Ca){this.wa=a;this.ba=1;for(a=0;a<this.c.length;++a)Ka(this,this.c[a].Ia,this.c[a].Ba);this.c=[];this.b=[]}};
w.prototype.a=function(a){if(this.ba==Ca){this.wa=a;this.ba=2;for(a=0;a<this.b.length;++a)Ka(this,this.b[a].Ia,this.b[a].Ba);this.c=[];this.b=[]}};function Ka(a,b,c){Ja(function(){if(c&&"function"==typeof c){try{var a=c(this.wa)}catch(e){b.a(e);return}a instanceof w?a==b?b.a(new TypeError("Chaining cycle detected")):a.then(b.W.bind(b),b.a.bind(b)):b.W(a)}else 1==this.ba?b.W(this.wa):b.a(this.wa)}.bind(a))}function Ja(){};function La(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=Ma)}p("shaka.polyfill.VideoPlaybackQuality.install",La);function Ma(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function Na(a,b){for(var c=[],d=0;d<a.length;++d){for(var e=!1,f=0;f<c.length&&!(e=b?b(a[d],c[f]):a[d]===c[f]);++f);e||c.push(a[d])}return c};function x(){return Date.now()+Oa}var Oa=0;function Pa(a){this.b=a;this.c=0==Qa;this.a=0}var Qa=1;function Ra(a){return a.a<a.b.byteLength}function Sa(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function y(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function Ta(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function Ua(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function z(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function Va(a){this.b=a;this.a=new Pa(a);Wa||(Wa=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var Wa;
function Xa(a){var b;b=Ya(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=Ya(a);a:{for(d=0;d<Wa.length;d++)if(Za(c,Wa[d])){d=!0;break a}d=!1}if(d)c=a.b.byteLength-a.a.a;else{if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d}c=a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a;d=new DataView(a.b.buffer,
a.b.byteOffset+a.a.a,c);z(a.a,c);return new $a(b,d)}function Ya(a){var b=Sa(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=Sa(a.a);return d}function $a(a,b){this.id=a;this.a=b}
function ab(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&a.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b};var bb={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function cb(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}cb.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function db(a){return a.b/(1-Math.pow(a.c,a.a))};function A(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function B(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function eb(a,b,c){fb(b);fb(c);return c==b||a>=gb&&c==b.split("-")[0]||a>=hb&&c.split("-")[0]==b.split("-")[0]?!0:!1}var gb=1,hb=2;function fb(a){a=a.toLowerCase().split("-");var b=ib[a[0]];b&&(a[0]=b);return a.join("-")}
var ib={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function jb(a){return Object.keys(a).map(function(b){return a[b]})}function kb(a,b){return lb(a,b,"boolean")}function mb(a,b){var c=lb(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function nb(a,b){return lb(a,b,"string")}
function lb(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}function ob(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function D(){this.a={}}D.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};D.prototype.set=function(a,b){this.a[a]=b};D.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function pb(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function qb(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function rb(a){var b=[],c;for(c in a.a)b.push(c);return b};function E(){this.a=new D}E.prototype.destroy=function(){sb(this);this.a=null};function F(a,b,c,d){b=new tb(b,c,d);a.a.push(c,b)}E.prototype.sa=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.sa(),qb(this.a,b,e))}};function sb(a){for(var b=pb(a.a),c=0;c<b.length;++c)b[c].sa();a.a.a={}}function tb(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
tb.prototype.sa=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function G(a){this.ya=new D;this.v=a}p("shaka.util.FakeEventTarget",G);G.prototype.addEventListener=function(a,b,c){c||this.ya.push(a,b)};G.prototype.removeEventListener=function(a,b,c){c||qb(this.ya,a,b)};
G.prototype.dispatchEvent=function(a){a.hasOwnProperty("srcElement")||(delete a.srcElement,Object.defineProperty(a,"srcElement",{get:function(){return null}}));if(a.hasOwnProperty("target"))a.target=this;else{delete a.target;var b=this;Object.defineProperty(a,"target",{get:function(){return b},set:function(a){b=a}})}if(a.hasOwnProperty("currentTarget"))a.currentTarget=null;else{delete a.currentTarget;var c=null;Object.defineProperty(a,"currentTarget",{get:function(){return c},set:function(a){c=a}})}return ub(this,
a)};function ub(a,b){b.currentTarget=a;for(var c=a.ya.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.v&&b.bubbles&&ub(a.v,b);return b.defaultPrevented};function vb(){G.call(this,null);this.a=new cb(3);this.c=new cb(10);this.b=0}q(vb,G);p("shaka.util.EWMABandwidthEstimator",vb);vb.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(A({type:"bandwidth"}));this.b=Date.now()}};vb.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(db(this.a),db(this.c))};vb.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
vb.prototype.supportsCaching=function(){return!1};function H(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=H.prototype.destroy;return c}H.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function wb(a){return a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function xb(){this.g=new H;this.f=!1;this.a=null;this.b=[];this.c=null}function yb(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}xb.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});zb(this,void 0)};xb.prototype.end=function(){this.b.splice(1)};
function zb(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(I(a,function(a){this.a?(this.b=[],this.c=null,Ab(this)):(this.b.shift(),this.b.length?zb(this,a):(this.g.resolve(a),this.c=null))})).catch(I(a,function(a){this.b=[];this.c=null;this.a?Ab(this):this.g.reject(a)}))}function Ab(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function I(a,b){return b.bind(a)};function Bb(a,b){G.call(this,b);this.a=null;this.h=a}q(Bb,G);
function Cb(a){if(!window.indexedDB)return a=Error("Persistant storage requires IndexedDB support."),a.type="storage",Promise.reject(a);if(a.a)return a=Error("A database connection is already open."),a.type="storage",Promise.reject(a);var b=new H,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=I(a,function(a){this.a=a.target.result;Db(this,"group_store",{keyPath:"group_id"});Db(this,"stream_index_store",{keyPath:"stream_id"});a=Db(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",
["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=I(a,function(a){this.a=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function Eb(a){a.a&&(a.a.close(),a.a=null)}function Db(a,b,c){a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c)}function Fb(a){return Gb(a,"content_store")}function Hb(a){return Gb(a,"stream_index_store")}function Ib(a){return Gb(a,"group_store")}
function Gb(a,b){return a.a.transaction([b],a.h).objectStore(b)}function Jb(a,b){var c=new H,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c};function Kb(){Bb.call(this,"readonly",null)}q(Kb,Bb);function Lb(a){var b=new H,c=[],d=Ib(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function Mb(a,b){return Jb(Ib(a),b).then(I(a,function(a){a.session_ids=Na(a.session_ids);return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):Nb(this,a.stream_ids[0]).then(function(b){a.duration=b.duration;a.key_system=b.key_system;a.license_server=b.license_server;a.with_credentials=b.with_credentials;a.distinctive_identifier=b.distinctive_identifier;a.audio_robustness=b.audio_robustness;a.video_robustness=b.video_robustness;return Promise.resolve(a)})}))}
function Nb(a,b){return Jb(Hb(a),b)}function Pb(a,b,c){return Jb(Fb(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})};function Qb(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.i=a;this.c=b;this.l=c;this.j=new E;this.g=null;this.b=[];this.w=0;this.f=this.a=null;this.s=0;F(this.j,this.c,"updateend",this.B.bind(this))}var Rb=1/60;Qb.prototype.destroy=function(){Sb(this).catch(function(){});this.f&&this.f.destroy();this.a=this.f=null;this.g&&(Eb(this.g),this.g=null);this.b=null;this.j.destroy();this.i=this.c=this.j=null};
function Tb(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-Rb,f=c.end(d)+Rb;if(b>=e&&b<=f)return c.end(d)-b}return 0}
function Ub(a,b,c,d){if(a.a)return a=Error("Cannot fetch ("+a.v+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new xb;c!=a.c.timestampOffset&&(a.c.timestampOffset=c);"idb"!=b.url.b[0].P||a.g||(a.g=new Kb,yb(a.a,function(){return[Cb(this.g)]}.bind(a)));d&&yb(a.a,function(){return[Vb(this,d),this.h.bind(this)]}.bind(a));yb(a.a,function(){var a=b.a?b.a-b.b:1,c=new Wb;c.a=3;c.h=1E3*a;c.c=1E3*this.s;c.i=this.g;return[Xb(b.url,c,this.l),J.prototype.g.bind(b.url)]}.bind(a));
yb(a.a,I(a,function(a){this.l.getBandwidth();return[Vb(this,a),this.h.bind(this)]}));var e=0==a.c.buffered.length&&0==a.b.length,f=null;yb(a.a,function(){if(0==this.c.buffered.length){var a=Error("Failed to buffer segment ("+this.v+").");a.type="stream";return[Promise.reject(a)]}e&&(a=b.b,f=this.c.buffered.start(0)-a);a=Yb(this.b,b.b);0<=a?this.b.splice(a+1,0,b):this.b.push(b)}.bind(a));return Zb(a).then(function(){return Promise.resolve(f)}.bind(a))}
function $b(a){if(a.a)return a=Error("Cannot clear ("+a.v+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new xb;yb(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,this.i.duration)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new H}return[a,this.h.bind(this)]}.bind(a));return Zb(a)}
function ac(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.v+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new xb;yb(a.a,function(){return[bc(this,b),this.h.bind(this)]}.bind(a));return Zb(a)}function Sb(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new H,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function Zb(a){a.a.start();return a.a.g.then(I(a,function(){this.a=null})).catch(I(a,function(a){this.a=null;return Promise.reject(a)}))}
function Vb(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new H;return a.f}function bc(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=Yb(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].b,a.i.duration)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new H;return a.f}Qb.prototype.h=function(){"open"==this.i.readyState&&this.c.abort()};Qb.prototype.B=function(){this.f.resolve();this.f=null};function cc(a){return String.fromCharCode.apply(null,a)}p("shaka.util.Uint8ArrayUtils.toString",cc);function dc(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}p("shaka.util.Uint8ArrayUtils.fromString",dc);p("shaka.util.Uint8ArrayUtils.toBase64",function(a,b){var c=void 0==b?!0:b,d=window.btoa(cc(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")});function ec(a){return dc(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
p("shaka.util.Uint8ArrayUtils.fromBase64",ec);p("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function fc(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}p("shaka.util.Uint8ArrayUtils.toHex",fc);function Za(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function gc(){this.h=this.a="";this.i=!1;this.s=this.l=null;this.v=this.g=!1;this.j=this.f="";this.c=null;this.b=[]}
function hc(a){var b=new gc;if(!a)return b;var c=nb(a,"keySystem");if(null!=c)b.a=c;else throw Error("'keySystem' cannot be null.");var d=nb(a,"licenseServerUrl");if(null!=d)b.h=d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");c=kb(a,"withCredentials");null!=c&&(b.i=c);c=ob(a,"licensePostProcessor",Function);null!=c&&(b.l=c);c=ob(a,"licensePreProcessor",Function);null!=c&&(b.s=c);c=kb(a,"distinctiveIdentifierRequired");null!=c&&(b.g=c);c=kb(a,
"persistentStateRequired");null!=c&&(b.v=c);c=nb(a,"audioRobustness");null!=c&&(b.f=c);c=nb(a,"videoRobustness");null!=c&&(b.j=c);c=ob(a,"serverCertificate",Uint8Array);null!=c&&(b.c=c);if(c=ob(a,"initData",Object)){a=ob(c,"initData",Uint8Array);if(null==a)throw Error("'initData.initData' cannot be null.");c=nb(c,"initDataType");if(null==c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c})}return b}
function ic(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=Na(c,jc)}function jc(a,b){return a.initDataType==b.initDataType&&Za(a.initData,b.initData)};function kc(a,b){try{var c=new lc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function mc(a){var b=this.mediaKeys;b&&b!=a&&nc(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&nc(a,this);return Promise.resolve()}
function lc(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},l=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var n=g.audioCapabilities[m];
n.contentType&&(l=!0,e.canPlayType(n.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(n),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)n=g.videoCapabilities[m],n.contentType&&(l=!0,e.canPlayType(n.contentType,this.a)&&(h.videoCapabilities.push(n),d=!0));l||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}c=
"Unsupported keySystem";if("org.w3.clearkey"==a||"com.widevine.alpha"==a)c="None of the requested configurations were supported.";c=Error(c);c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}lc.prototype.createMediaKeys=function(){var a=new oc(this.a);return Promise.resolve(a)};lc.prototype.getConfiguration=function(){return this.b};function oc(a){this.g=a;this.b=null;this.a=new E;this.c=[];this.f={}}
function nc(a,b){a.b=b;sb(a.a);b&&(F(a.a,b,"webkitneedkey",a.Sb.bind(a)),F(a.a,b,"webkitkeymessage",a.Rb.bind(a)),F(a.a,b,"webkitkeyadded",a.Pb.bind(a)),F(a.a,b,"webkitkeyerror",a.Qb.bind(a)))}k=oc.prototype;k.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new pc(a,this.g,b);this.c.push(b);return b};
k.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};k.Sb=function(a){a=A({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};k.Rb=function(a){var b=qc(this,a.sessionId);b&&(a=A({type:"message",messageType:void 0==b.keyStatuses.Fa()?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};
k.Pb=function(a){if(a=qc(this,a.sessionId))rc(a,"usable"),a.a&&a.a.resolve(),a.a=null};
k.Qb=function(a){var b=qc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?rc(b,"output-restricted"):1==c?rc(b,"expired"):rc(b,"internal-error"))}};
function qc(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function pc(a,b,c){G.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new H;this.keyStatuses=new sc}q(pc,G);
function tc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=dc("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=dc("PERSISTENT|"+cc(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new H;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}k=pc.prototype;k.Qa=function(a,b){if(this.a)this.a.then(this.Qa.bind(this,a,b)).catch(this.Qa.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=cc(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=ec(d.keys[0].k),d=ec(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function rc(a,b){a.keyStatuses.Ma(b);var c=A({type:"keystatuseschange"});a.dispatchEvent(c)}k.generateRequest=function(a,b){return tc(this,b,null)};k.load=function(a){return"persistent-license"==this.g?tc(this,null,a):Promise.reject(Error("Not a persistent session."))};k.update=function(a){var b=new H;this.Qa(b,a);return b};
k.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};k.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function uc(a){this.b=a;this.a=0}
uc.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function sc(){this.size=0;this.a=void 0}var vc;k=sc.prototype;k.Ma=function(a){this.size=void 0==a?0:1;this.a=a};k.Fa=function(){return this.a};k.entries=function(){var a=vc,b=[];this.a&&b.push([a,this.a]);return new uc(b)};k.forEach=function(a){this.a&&a(this.a,vc)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=vc;return this.a&&Za(new Uint8Array(a),b)?!0:!1};
k.keys=function(){var a=vc,b=[];this.a&&b.push(a);return new uc(b)};k.values=function(){var a=[];this.a&&a.push(this.a);return new uc(a)};function wc(a){this.systemIds=[];this.cencKeyIds=[];this.a=[];a=new Pa(new DataView(a.buffer));try{for(;Ra(a);){var b=a.a,c=y(a),d=y(a);1==c?c=Ta(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)z(a,c-(a.a-b));else{var e=Sa(a);if(1<e)z(a,c-(a.a-b));else{z(a,3);var f=fc(Ua(a)),g=[];if(0<e)for(var h=y(a),l=0;l<h;++l){var m=fc(Ua(a));g.push(m)}var n=y(a);z(a,n);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);this.a.push({start:b,end:a.a-1});a.a!=b+c&&z(a,c-(a.a-b))}}}}catch(t){}};function xc(a,b){try{var c=new yc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}
function yc(a,b){this.keySystem=a;for(var c=!1,d=0;d<b.length;++d){var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"]},g=!1;if(e.audioCapabilities)for(var h=0;h<e.audioCapabilities.length;++h){var l=e.audioCapabilities[h];if(l.contentType){var g=!0,m=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,m)&&(f.audioCapabilities.push(l),c=!0)}}if(e.videoCapabilities)for(h=
0;h<e.videoCapabilities.length;++h)l=e.videoCapabilities[h],l.contentType&&(g=!0,m=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,m)&&(f.videoCapabilities.push(l),c=!0));g||(c=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==e.persistentState&&(f.persistentState="required",f.sessionTypes=["persistent-license"]);if(c){this.a=f;return}}c=Error("Unsupported keySystem");c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}
yc.prototype.createMediaKeys=function(){var a=new zc(this.keySystem);return Promise.resolve(a)};yc.prototype.getConfiguration=function(){return this.a};function Ac(a){var b=this.mediaKeys;b&&b!=a&&Bc(b,null);delete this.mediaKeys;return(this.mediaKeys=a)?Bc(a,this):Promise.resolve()}function zc(a){this.a=new MSMediaKeys(a);this.b=new E}zc.prototype.createSession=function(a){if("temporary"!=(a||"temporary"))throw new TypeError("Session type "+a+" is unsupported on this platform.");return new Cc(this.a)};
zc.prototype.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};function Bc(a,b){function c(){b.msSetMediaKeys(d.a);b.removeEventListener("loadedmetadata",c)}sb(a.b);if(!b)return Promise.resolve();F(a.b,b,"msneedkey",Dc);var d=a;try{return 1<=b.readyState?b.msSetMediaKeys(a.a):b.addEventListener("loadedmetadata",c),Promise.resolve()}catch(e){return Promise.reject(e)}}
function Cc(a){G.call(this,null);this.c=null;this.g=a;this.b=this.a=null;this.f=new E;this.sessionId="";this.expiration=NaN;this.closed=new H;this.keyStatuses=new Ec}q(Cc,G);k=Cc.prototype;k.generateRequest=function(a,b){this.a=new H;try{this.c=this.g.createSession("video/mp4",b),F(this.f,this.c,"mskeymessage",this.Eb.bind(this)),F(this.f,this.c,"mskeyadded",this.Cb.bind(this)),F(this.f,this.c,"mskeyerror",this.Db.bind(this)),Fc(this,"status-pending")}catch(c){this.a.reject(c)}return this.a};
k.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))};k.update=function(a){this.b=new H;try{this.c.update(a)}catch(b){this.b.reject(b)}return this.b};k.close=function(){try{this.c.close(),this.closed.resolve(),sb(this.f)}catch(a){this.closed.reject(a)}return this.closed};k.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Dc(a){var b=a.initData;if(b){var c=new wc(b);if(1>=c.a.length)a=b;else{var d=[];for(a=0;a<c.a.length;a++)d.push(b.subarray(c.a[a].start,c.a[a].end+1));b=Na(d,Gc);for(a=c=0;a<b.length;a++)c+=b[a].length;c=new Uint8Array(c);for(a=d=0;a<b.length;a++)c.set(b[a],d),d+=b[a].length;a=c}}else a=b;a=A({type:"encrypted",initDataType:"cenc",initData:a});this.dispatchEvent(a)}function Gc(a,b){return Za(a,b)}
k.Eb=function(a){this.a&&(this.a.resolve(),this.a=null);a=A({type:"message",messageType:void 0==this.keyStatuses.Fa()?"licenserequest":"licenserenewal",message:a.message.buffer});this.dispatchEvent(a)};k.Cb=function(){this.a?(this.a.resolve(),this.a=null):this.b&&(Fc(this,"usable"),this.b.resolve(),this.b=null)};
k.Db=function(){var a=Error("EME v20140218 key error");a.errorCode=this.c.error;if(null!=this.a)this.a.reject(a),this.a=null;else if(null!=this.b)this.b.reject(a),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Fc(this,"output-not-allowed");default:Fc(this,"internal-error")}};function Fc(a,b){a.keyStatuses.Ma(b);var c=A({type:"keystatuseschange"});a.dispatchEvent(c)}function Hc(a){this.b=a;this.a=0}
Hc.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function Ec(){this.size=0;this.a=void 0}var Ic;k=Ec.prototype;k.Ma=function(a){this.size=void 0==a?0:1;this.a=a};k.Fa=function(){return this.a};k.entries=function(){var a=Ic,b=[];this.a&&b.push([a,this.a]);return new Hc(b)};k.forEach=function(a){this.a&&a(this.a,Ic)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=Ic;return this.a&&Za(new Uint8Array(a),b)?!0:!1};
k.keys=function(){var a=Ic,b=[];this.a&&b.push(a);return new Hc(b)};k.values=function(){var a=[];this.a&&a.push(this.a);return new Hc(a)};function Jc(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(vc=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=kc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=mc,window.MediaKeys=oc,window.MediaKeySystemAccess=lc):window.MSMediaKeys?(Ic=new Uint8Array([0]),delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Ac,window.MediaKeys=zc,window.MediaKeySystemAccess=yc,Navigator.prototype.requestMediaKeySystemAccess=xc):(Navigator.prototype.requestMediaKeySystemAccess=ya,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=za,window.MediaKeys=Aa,window.MediaKeySystemAccess=Ba))}p("shaka.polyfill.MediaKeys.install",Jc);p("shaka.polyfill.installAll",function(){ta();wa();La();Da();Jc()});var Kc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function K(a){var b;a instanceof K?(Lc(this,a.P),this.ca=a.ca,this.S=a.S,Mc(this,a.ia),this.O=a.O,Nc(this,a.a.clone()),this.aa=a.aa):a&&(b=String(a).match(Kc))?(Lc(this,b[1]||"",!0),this.ca=Oc(b[2]||""),this.S=Oc(b[3]||"",!0),Mc(this,b[4]),this.O=Oc(b[5]||"",!0),Nc(this,b[6]||"",!0),this.aa=Oc(b[7]||"")):this.a=new Pc(null)}k=K.prototype;k.P="";k.ca="";k.S="";k.ia=null;k.O="";k.aa="";
k.toString=function(){var a=[],b=this.P;b&&a.push(Qc(b,Rc,!0),":");if(b=this.S){a.push("//");var c=this.ca;c&&a.push(Qc(c,Rc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.ia;null!=b&&a.push(":",String(b))}if(b=this.O)this.S&&"/"!=b.charAt(0)&&a.push("/"),a.push(Qc(b,"/"==b.charAt(0)?Tc:Uc,!0));(b=this.a.toString())&&a.push("?",b);(b=this.aa)&&a.push("#",Qc(b,Vc));return a.join("")};
k.resolve=function(a){var b=this.clone();"data"===b.P&&(b=new K);var c=!!a.P;c?Lc(b,a.P):c=!!a.ca;c?b.ca=a.ca:c=!!a.S;c?b.S=a.S:c=null!=a.ia;var d=a.O;if(c)Mc(b,a.ia);else if(c=!!a.O){if("/"!=d.charAt(0))if(this.S&&!this.O)d="/"+d;else{var e=b.O.lastIndexOf("/");-1!=e&&(d=b.O.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.O=d:c=""!==a.a.toString();c?Nc(b,a.a.clone()):c=!!a.aa;c&&(b.aa=a.aa);return b};k.clone=function(){return new K(this)};function Lc(a,b,c){a.P=c?Oc(b,!0):b;a.P&&(a.P=a.P.replace(/:$/,""))}function Mc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.ia=b}else a.ia=null}function Nc(a,b,c){b instanceof Pc?a.a=b:(c||(b=Qc(b,Wc)),a.a=new Pc(b))}
function Oc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function Qc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Xc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Xc(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Rc=/[#\/\?@]/g,Uc=/[\#\?:]/g,Tc=/[\#\?]/g,Wc=/[\#\?@]/g,Vc=/#/g;function Pc(a){this.b=a||null}Pc.prototype.a=null;Pc.prototype.c=null;
function Yc(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";Yc(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
Pc.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};Pc.prototype.clone=function(){var a=new Pc;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function Zc(){this.id=this.url=null;this.type="static";this.b=this.j=this.u=this.jb=null;this.h=5;this.f=this.c=this.g=null;this.i=1;this.a=[]}function $c(){this.g=this.f=this.c=this.u=this.a=this.start=this.id=null;this.b=[]}function ad(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.u=null;this.j=[];this.a=[]}function bd(){this.value=null}function cd(){this.contentType=this.lang=this.id=null}
function dd(){this.a=this.b=this.g=this.u=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[]}function ed(){this.b=this.a=this.c=this.f=null}function fd(){this.parsedPssh=this.psshBox=null}function gd(){this.url=null}function hd(){this.url=null}function id(){this.u=null;this.g=1;this.c=this.b=this.a=this.f=null}id.prototype.clone=function(){var a=new id;a.u=jd(this.u);a.g=this.g;a.f=this.f;a.a=L(this.a);a.b=L(this.b);a.c=L(this.c);return a};
function kd(){this.a=this.url=null}kd.prototype.clone=function(){var a=new kd;a.url=jd(this.url);a.a=L(this.a);return a};function ld(){this.a=this.url=null}ld.prototype.clone=function(){var a=new ld;a.url=jd(this.url);a.a=L(this.a);return a};function md(){this.u=null;this.f=1;this.b=this.g=null;this.i=1;this.h=null;this.a=[];this.c=null}md.prototype.clone=function(){var a=new md;a.u=jd(this.u);a.f=this.f;a.g=this.g;a.b=this.b;a.i=this.i;a.h=L(this.h);a.a=jd(this.a)||[];a.c=L(this.c);return a};
function nd(){this.a=this.b=null}nd.prototype.clone=function(){var a=new nd;a.b=jd(this.b);a.a=L(this.a);return a};function od(){this.a=1;this.b=this.i=null;this.j=1;this.c=this.g=this.f=this.h=null}od.prototype.clone=function(){var a=new od;a.a=this.a;a.i=this.i;a.b=this.b;a.j=this.j;a.h=this.h;a.f=this.f;a.g=this.g;a.c=L(this.c);return a};function pd(){this.a=[]}pd.prototype.clone=function(){var a=new pd;a.a=jd(this.a)||[];return a};function qd(){this.c=this.a=this.b=null}
qd.prototype.clone=function(){var a=new qd;a.b=this.b;a.a=this.a;a.c=this.c;return a};function rd(a,b){this.na=a;this.end=b}rd.prototype.clone=function(){return new rd(this.na,this.end)};Zc.TAG_NAME="MPD";$c.TAG_NAME="Period";ad.TAG_NAME="AdaptationSet";bd.TAG_NAME="Role";cd.TAG_NAME="ContentComponent";dd.TAG_NAME="Representation";ed.TAG_NAME="ContentProtection";fd.TAG_NAME="cenc:pssh";gd.TAG_NAME="BaseURL";hd.TAG_NAME="Location";id.TAG_NAME="SegmentBase";kd.TAG_NAME="RepresentationIndex";
ld.TAG_NAME="Initialization";md.TAG_NAME="SegmentList";nd.TAG_NAME="SegmentURL";od.TAG_NAME="SegmentTemplate";pd.TAG_NAME="SegmentTimeline";qd.TAG_NAME="S";
Zc.prototype.parse=function(a,b){this.url=a.jb;this.id=M(b,"id",N);this.type=M(b,"type",N)||"static";this.b=M(b,"mediaPresentationDuration",sd);this.h=M(b,"minBufferTime",sd,this.h);this.g=M(b,"minimumUpdatePeriod",sd,this.g);this.c=M(b,"availabilityStartTime",td,this.c);this.f=M(b,"timeShiftBufferDepth",sd,this.f);this.i=M(b,"suggestedPresentationDelay",sd,this.i);var c=a.u,d=O(this,b,gd);this.u=ud(c,d);if(d=P(this,b,hd))this.j=vd(c,d.url);this.a=O(this,b,$c)};
$c.prototype.parse=function(a,b){this.id=M(b,"id",N);this.start=M(b,"start",sd);this.a=M(b,"duration",sd);var c=O(this,b,gd);this.u=ud(a.u,c);this.c=P(this,b,id);this.f=P(this,b,md);this.g=P(this,b,od);this.b=O(this,b,ad);wd(this)};function wd(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
ad.prototype.parse=function(a,b){var c=P(this,b,cd)||{},d=P(this,b,bd);this.id=M(b,"id",N);this.group=M(b,"group",Q);this.lang=M(b,"lang",N,c.lang);this.contentType=M(b,"contentType",N,c.contentType);this.width=M(b,"width",R);this.height=M(b,"height",R);this.b=M(b,"mimeType",N);this.i=M(b,"codecs",N);this.c=d&&"main"==d.value;this.lang&&(this.lang=fb(this.lang));c=O(this,b,gd);this.u=ud(a.u,c);this.j=O(this,b,ed);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?xd(this,
b,a.c):P(this,b,id);this.g=a.f?xd(this,b,a.f):P(this,b,md);this.h=a.g?xd(this,b,a.g):P(this,b,od);this.a=O(this,b,dd);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};bd.prototype.parse=function(a,b){this.value=M(b,"value",N)};cd.prototype.parse=function(a,b){this.id=M(b,"id",N);this.lang=M(b,"lang",N);this.contentType=M(b,"contentType",N);this.lang&&(this.lang=fb(this.lang))};
dd.prototype.parse=function(a,b){this.id=M(b,"id",N);this.bandwidth=M(b,"bandwidth",R);this.width=M(b,"width",R,a.width);this.height=M(b,"height",R,a.height);this.f=M(b,"mimeType",N,a.b);this.h=M(b,"codecs",N,a.i);this.lang=a.lang;var c=O(this,b,gd);this.u=ud(a.u,c);this.c=O(this,b,ed);this.g=a.f?xd(this,b,a.f):P(this,b,id);this.b=a.g?xd(this,b,a.g):P(this,b,md);this.a=a.h?xd(this,b,a.h):P(this,b,od);this.c=this.c.concat(a.j)};
ed.prototype.parse=function(a,b){this.f=b;this.c=M(b,"schemeIdUri",N);var c=M(b,"cenc:default_KID",N);c&&(this.b=c.replace(/[-]/g,""));this.a=P(this,b,fd)};fd.prototype.parse=function(a,b){var c=yd(b);if(c){this.psshBox=ec(c);try{this.parsedPssh=new wc(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};gd.prototype.parse=function(a,b){this.url=yd(b)};hd.prototype.parse=function(a,b){this.url=yd(b)};
id.prototype.parse=function(a,b){this.u=a.u||this.u;this.g=M(b,"timescale",R,this.g);this.f=M(b,"presentationTimeOffset",Q,this.f);this.a=M(b,"indexRange",zd,this.a);this.b=P(this,b,kd)||this.b;this.c=P(this,b,ld)||this.c};kd.prototype.parse=function(a,b){var c=M(b,"sourceURL",N);this.url=vd(a.u,c);this.a=M(b,"range",zd,L(a.a))};ld.prototype.parse=function(a,b){var c=M(b,"sourceURL",N);this.url=vd(a.u,c);this.a=M(b,"range",zd)};
md.prototype.parse=function(a,b){this.u=a.u||this.u;this.f=M(b,"timescale",R,this.f);this.g=M(b,"presentationTimeOffset",Q,this.g);this.b=M(b,"duration",R,this.b);var c=M(b,"startNumber",R);null!=c&&(this.i=c);this.h=P(this,b,ld)||this.h;this.a=(c=O(this,b,nd))&&0<c.length?c:this.a;this.c=P(this,b,pd)||this.c};nd.prototype.parse=function(a,b){var c=M(b,"media",N);this.b=vd(a.u,c);this.a=M(b,"mediaRange",zd)};
od.prototype.parse=function(a,b){this.a=M(b,"timescale",R,this.a);this.i=M(b,"presentationTimeOffset",Q,this.i);this.b=M(b,"duration",R,this.b);var c=M(b,"startNumber",Q);null!=c&&(this.j=c);this.h=M(b,"media",N,this.h);this.f=M(b,"index",N,this.f);this.g=M(b,"initialization",N,this.g);this.c=P(this,b,pd)||this.c};pd.prototype.parse=function(a,b){this.a=O(this,b,qd)};qd.prototype.parse=function(a,b){this.b=M(b,"t",Q);this.a=M(b,"d",Q);this.c=M(b,"r",Ad)};
function ud(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new K(e)):(e=vd(a.slice(0,1),e),c.push(e[0]))}return c}function vd(a,b){if(!b)return a;var c=new K(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function xd(a,b,c){var d=L(c);(b=Bd(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function P(a,b,c){var d=null;if(b=Bd(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function Bd(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function O(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function yd(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function jd(a){return a?a.map(function(a){return a.clone()}):null}function L(a){return a?a.clone():null}
function M(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function td(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function sd(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=Q(b[1]);c&&(a+=31536E3*c);(c=Q(b[2]))&&(a+=2592E3*c);(c=Q(b[3]))&&(a+=86400*c);(c=Q(b[4]))&&(a+=3600*c);(c=Q(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function zd(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=Q(b[1]);if(null==a)return null;b=Q(b[2]);return null==b?null:new rd(a,b)}function Ad(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function R(a){a=window.parseInt(a,10);return 0<a?a:null}function Q(a){a=window.parseInt(a,10);return 0<=a?a:null}function N(a){return a};function Cd(a,b){this.url=a;this.b=b||new Wb;this.g=this.i=this.h=0;this.a=null;this.c=new H;this.f=null}function Wb(){this.body=null;this.a=1;this.h=1E3;this.c=0;this.method="GET";this.f="arraybuffer";this.b={};this.g=this.j=!1;this.i=null}var Dd=!0;function Ed(a){Fd(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function Fd(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}k=Cd.prototype;
k.sb=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=dc(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);Ed(this);return b}if(0==this.url.lastIndexOf("idb:",0))return Gd(this);this.h++;this.i=Date.now();this.g||
(this.g=this.b.h);this.a=new XMLHttpRequest;a=this.url;Dd&&(this.f&&!this.f.supportsCaching()||this.b.g)&&(a=new K(a),Yc(a.a,"_",Date.now()),a=a.toString());this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.c;this.a.withCredentials=this.b.j;this.a.onload=this.Ab.bind(this);this.b.g&&(this.a.onreadystatechange=this.Hb.bind(this));this.a.onerror=this.Yb.bind(this);this.a.ontimeout=this.Mb.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);
return this.c};function Gd(a){var b=a.url.split("/");return Pb(a.b.i,parseInt(b[2],10),parseInt(b[3],10)).then(I(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.c;a.resolve(b);Ed(this);return a})).catch(I(a,function(a){Ed(this);return Promise.reject(a)}))}function Hd(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.bc=a.a;return b}
k.Ab=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),Ed(this)):this.h<this.b.a?Id(this):(a=Hd(this,"HTTP error.","net"),this.c.reject(a),Ed(this))};k.Hb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(Oa=a-Date.now())}};k.Yb=function(){var a=Hd(this,"Network failure.","net");this.c.reject(a);Ed(this)};
k.Mb=function(){if(this.h<this.b.a)Id(this);else{var a=Hd(this,"Request timed out.","net");this.c.reject(a);Ed(this)}};function Id(a){Fd(a);window.setTimeout(a.sb.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function J(a,b,c,d){this.b=b;this.f=c||0;this.i=null!=d?d:null;this.c=this.a=null;this.j=a;this.h=null}function Jd(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}function Xb(a,b,c){if(a.a)return a.a;b=b||new Wb;if(a.f||a.i)b.b.Range="bytes="+(a.f+"-"+(null!=a.i?a.i:""));a.a=Kd(a,0,b,c);return a.a}
J.prototype.g=function(){if(this.c){this.a=null;var a=this.c;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=Hd(a,"Request aborted.","aborted");a.c.reject(b);Ed(a)}this.h=this.c=null}};
function Kd(a,b,c,d){var e=a.b[b].toString();a.j&&(e=a.j(e,c.b)||e);a.c=new Cd(e,c);d&&(a.c.f=d);e=a.c.sb().then(I(a,function(a){this.h=this.c=this.a=null;this.h=a.a?new K(a.a):this.b[b];return Promise.resolve(a.response)}));return e=e.catch(I(a,function(a){if(this.a&&b+1<this.b.length)return this.a=Kd(this,b+1,c,d);this.a=this.c=null;return Promise.reject(a)}))}J.prototype.clone=function(){return new J(this.j,this.b.map(function(a){return a.clone()}),this.f,this.i)};J.prototype.toString=function(){return this.b[0].toString()};function Ld(a,b){this.a=new Wb;this.a.f="text";this.a.a=3;this.a.c=1E3*(null!=b?b:0);this.a.g=!0;this.b=a}function Md(a){var b=a.b;return Xb(b,a.a).then(function(a){var d;d=b.b;var e=[b.h];d=(a=(new DOMParser).parseFromString(a,"text/xml"))?P({jb:d,u:e},a,Zc):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="dash";return Promise.reject(d)})};function Nd(a,b,c,d){for(var e=b.a,f=[],g=0;g<d;++g){var h=g+c,l=(h-1)*e.b,m=l/e.a,n=(l+e.b)/e.a,h=Od(a,b,e.j+h-1,l);if(!h)return null;f.push(new Pd(m,n,h))}return f}function Od(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.u?new J(a,b.u,0,null):null;c=Qd(e,b.id,c,b.bandwidth,d);if(!c)return null;b=Jd(b.u,c);return new J(a,b,0,null)}
function Qd(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new K(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function Rd(a,b,c){var d=0;b*=c;a=a.a;c=[];for(var e=0;e<a.length&&a[e].a;++e){var f=a[e].b,f=null!=f?f:d,g=a[e].c||0;0>g&&(g=a[e].a,g=e+1===a.length?Math.ceil((a[0].b+b-f)/g)-1:Math.ceil((a[e+1].b-f)/g)-1);0<c.length&&f!=d&&(c[c.length-1].end=f);for(var h=0;h<=g;++h)d=f+a[e].a,c.push({start:f,end:d}),f=d}return c};function Sd(a,b){this.a=a;this.b=b||null}Sd.prototype.destroy=function(){this.a&&(this.a.g(),this.a=null);this.b=null};Sd.prototype.create=function(){return this.a?Xb(this.a):Promise.resolve(this.b)};function Pd(a,b,c){this.b=a;this.a=b;this.url=c}function Td(a,b,c){return new Pd(b,c,a.url)}function Yb(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.b&&(null==d.a||b<d.a))return c}return-1}function Ud(a,b){return a.map(function(a){return Td(a,a.b+b,null!=a.a?a.a+b:null)})};function Vd(){}
Vd.prototype.parse=function(a,b,c,d){var e=null;try{a:{var f=[],g=new Pa(a),h=y(g);if(1936286840!=y(g))e=null;else{1==h&&(h=Ta(g));var l=Sa(g);z(g,3);z(g,4);var m=y(g);if(0==m)e=null;else{var n,t;0==l?(n=y(g),t=y(g)):(n=Ta(g),t=Ta(g));z(g,2);var C=g.b.getUint16(g.a,g.c);g.a+=2;a=n;b=b+h+t;for(h=0;h<C;h++){var u=y(g);t=(u&2147483648)>>>31;var l=u&2147483647,v=y(g);y(g);if(1==t){e=null;break a}var va=new J(d,c,b,b+l-1);f.push(new Pd(a/m,(a+v)/m,va));a+=v;b+=l}e=f}}}}catch(Ob){if(!(Ob instanceof RangeError))throw Ob;
}return e};function S(a){this.o=a;this.i=0}S.prototype.destroy=function(){this.o=null};k=S.prototype;k.length=function(){return this.o.length};function T(a){if(0==a.o.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.o[0]}k.A=function(){if(0==this.o.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.o[this.o.length-1]};
k.get=function(a){if(0>a||a>=this.o.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.o[a]};k.la=function(a){a=Yb(this.o,a);return 0<=a?this.o[a]:null};k.Ha=function(a){Wd(this,a);return!0};
function Wd(a,b){a.i!=b.i&&(b=new S(Ud(b.o,a.i-b.i)));if(0==a.length())a.o=b.o.slice(0);else if(0!=b.length()&&null!=a.A().a&&!(null!=b.A().a&&b.A().a<a.A().a)){if(a.A().a<=T(b).b)var c=Td(a.A(),a.A().b,T(b).b),c=a.o.slice(0,-1).concat([c]);else{var d;for(d=0;d<a.o.length&&!(a.o[d].a>=T(b).b);++d);a.o[d].b<T(b).b?(c=Td(a.o[d],a.o[d].b,T(b).b),c=a.o.slice(0,d).concat([c])):(T(a).b>T(b).b||T(b),c=a.o.slice(0,d))}a.o=c.concat(b.o)}}
k.ka=function(a){var b=a-this.i;if(0==b)return 0;this.o=Ud(this.o,b);this.i=a;return b};k.Ea=function(){return 0<this.length()?{start:T(this).b,end:this.A().a}:{start:0,end:0}};function U(a,b,c,d){S.call(this,a);this.g=b;this.w=c;this.f=d;this.h=this.g.b||this.g.a.reduce(function(a,b){return null==b.a?NaN:a+b.a},0)||0;this.a=this.l=this.c=null;Xd(this)}q(U,S);U.prototype.destroy=function(){this.w=this.g=null;S.prototype.destroy.call(this)};U.prototype.la=function(a){Yd(this,x()/1E3);return S.prototype.la.call(this,a)};U.prototype.Ha=function(a){if(!(a instanceof U))return!1;Wd(this,a);this.h=Math.max(this.h,a.h);null==this.c?(this.f=a.f,Xd(this)):Zd(this);return!0};
function Xd(a){Zd(a);if(0!=a.length()){a.length();var b=null!=a.A().a?a.A().a:a.A().b;if(a.g.c>a.f)a.c=b;else{var c=a.f-(a.g.c+a.w.start);0>c?a.c=b:c<Math.max(a.A().b,a.A().a||0)?(a.A(),a.c=b):a.c=c}a.l=a.A().b;a.a=T(a).b}}U.prototype.ka=function(a){a=S.prototype.ka.call(this,a);Math.min.apply(null,this.o.filter(function(a){return null!=a.a}).map(function(a){return a.a-a.b}));null!=this.c&&(this.l+=a,this.a+=a,this.c+=a);return a};U.prototype.Ea=function(){return $d(this,x()/1E3)};
function $d(a,b){Yd(a,b);if(null==a.c||null==a.l||null==a.a)return{start:0,end:0};var c=Number.POSITIVE_INFINITY;a.h&&(c=a.h);var d=b-a.f,e=a.c+d;null!=a.g.f&&(e=e-a.a-a.g.f,0<e&&(a.a+=e));a.a=Math.min(a.a,c);d=a.l+d;if(d<a.a)return{start:a.a,end:a.a};d=0<a.length()?null!=a.A().a?Math.min(d,a.A().a):d:a.a;d=Math.max(d,a.a);d=Math.min(d,c);return{start:a.a,end:d}}
function Yd(a,b){Zd(a);if(null!=a.g.f)if(null==a.c)a.length();else{for(var c=a.c+(b-a.f),d=0,e=0;e<a.o.length;++e){var f=null;e<a.o.length-1?f=a.o[e+1].a:(f=a.o[e],f=null!=f.a?f.a+(f.a-f.b):null);if(null!=f&&f<c-a.g.f)++d;else break}0<d&&a.o.splice(0,d)}}function Zd(a){if(a.h){for(var b=0,c=a.o.length-1;0<=c;--c)if(a.o[c].b>a.h)++b;else break;0<b&&a.o.splice(-b)}};function ae(a,b,c,d,e){var f=1,g=0,h;if(a.c>d)h=null;else{var l=a.i||0,m=a.f||0;h=c.a;h=h.b/h.a;var n=d-(a.c+b.start);0>n?h=null:(m=n-2*h-m,0>m&&(m=0),m=Math.ceil(m/h)*h,n-=h,0>n?h=null:(l=Math.floor(n/h)*h-l,0>l&&(l=0),l=Math.floor(l/h)*h,h={Za:m/h+1,current:(l>=m?l:m)/h+1}))}h&&(f=h.Za,g=h.current-h.Za+1);f=Nd(e,c,f,g);if(null==f)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;U.call(this,f,a,b,d);this.s=c;this.v=this.b=0<this.length()?a.c+b.start+this.A().a:null;this.j=
h?h.current+1:null;this.B=e}q(ae,U);ae.prototype.destroy=function(){this.B=this.s=null;U.prototype.destroy.call(this)};ae.prototype.la=function(a){var b=x()/1E3;be(this,b);Yd(this,b);return S.prototype.la.call(this,a)};ae.prototype.Ha=function(a){if(null!=this.b||!(a instanceof ae)||null==a.b)return!1;this.b=a.b;this.v=a.v;this.j=a.j;this.f=a.f;this.h=a.h;Wd(this,a);be(this,x()/1E3);Xd(this);return!0};ae.prototype.ka=function(a){a=U.prototype.ka.call(this,a);null!=this.b&&(this.b+=a,this.v+=a);return a};
ae.prototype.Ea=function(){var a=x()/1E3;be(this,a);return $d(this,a)};function be(a,b){if(null!=a.b&&null!=a.v&&null!=a.j){var c=a.s.a,c=c.b/c.a,d=Math.floor((a.v+(b-a.f)-a.b)/c);if(0!=d){var e=Nd(a.B,a.s,a.j,d);Array.prototype.push.apply(a.o,Ud(e,a.i));a.b+=d*c;a.j+=d}}};function ce(a,b,c,d,e){this.f=a;this.b=b;this.c=c;this.h=d;this.a=null;this.g=e}ce.prototype.destroy=function(){this.g=this.c=this.b=this.f=null;this.a&&(this.a.destroy(),this.a=null)};
ce.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.f.type)try{this.a=new ae(this.f,this.b,this.c,this.h,this.g)}catch(a){return Promise.reject(a)}else{var b;b=this.c.a;if(b=Nd(this.g,this.c,1,Math.ceil(this.b.a/(b.b/b.a)))){if(0<b.length){var c=b[b.length-1];b[b.length-1]=Td(c,c.b,this.b.a)}b=new S(b)}else b=null;this.a=b;if(!this.a)return b=Error("Failed to generate SegmentReferences"),b.type="stream",Promise.reject(b)}return Promise.resolve(this.a)};function ne(a,b,c,d,e){this.c=a;this.b=b;this.g=c;this.a=null;this.h=d;this.f=e}ne.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
ne.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=this.g.b,b=[];a.c&&(b=Rd(a.c,a.f||1,this.b.a||0));var c=0;a.b&&a.i?c=(a.i-1)*a.b:0<b.length&&(c=b[0].start-(a.g||0));var d=a.a.length;0<b.length&&b.length!=a.a.length&&(d=Math.min(b.length,a.a.length));for(var e=[],f=0;f<d;++f){var g=a.a[f],h=c/a.f,l=null,m=null;a.b?(l=c+a.b,m=l/a.f):0<b.length?(l=b[f].end-(a.g||0),m=l/a.f):(m=h+this.b.a,l=m*a.f);var c=l,l=0,n=null;g.a&&(l=g.a.na,n=g.a.end);e.push(new Pd(h,m,new J(this.f,
g.b,l,n)))}"dynamic"==this.c.type?this.a=new U(e,this.c,this.b,this.h):this.a=new S(e);return Promise.resolve(this.a)};function oe(a,b,c,d,e){this.b=a;this.c=b;this.f=c;this.h=d;this.a=null;this.g=e}oe.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null)};
oe.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=this.f.a,b=Rd(a.c,a.a||1,this.c.a||0),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.a,g=b[d].end/a.a,e=Od(this.g,this.f,d+a.j,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);var h=(a.i||0)/a.a;c.push(new Pd(f-h,g-h,e))}"dynamic"==this.b.type?this.a=new U(c,this.b,this.c,this.h):this.a=new S(c);return Promise.resolve(this.a)};function pe(a){this.b=a;this.a=null}pe.prototype.destroy=function(){this.b=null;this.a&&(this.a.destroy(),this.a=null)};pe.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=[],b=0;b<this.b.length;++b){var c=this.b[b];a.push(new Pd(c.start_time,c.end_time,new J(null,[new K(c.url)],c.start_byte,null)))}this.b=null;this.a=new S(a);return Promise.resolve(this.a)};function qe(){this.C=re++;this.id=this.D=this.H=null;this.c=0;this.height=this.width=this.bandwidth=null;this.b=this.a="";this.f=[];this.N=!1;this.J=!0}var re=0;qe.prototype.destroy=function(){this.H&&(this.H.destroy(),this.H=null);this.D&&(this.D.destroy(),this.D=null)};function se(a){var b=a.a||"";a.b&&(b+='; codecs="'+a.b+'"');return b}function te(){this.C=ue++;this.id=null;this.contentType=this.lang="";this.b=!1;this.m=[];this.a=[]}var ue=0;
te.prototype.destroy=function(){for(var a=0;a<this.m.length;++a)this.m[a].destroy();this.a=this.m=null};function ve(a){for(var b=[],c=0;c<a.a.length;++c){var d=new we;d.id=a.C;d.a=a.a[c];d.contentType=a.contentType;d.b=a.m.length?se(a.m[0]):"";b.push(d)}return b}function xe(){this.id=null;this.start=0;this.b=null;this.a=[]}xe.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function ye(){this.b=!1;this.h=this.g=this.f=null;this.c=0;this.a=[]}
ye.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function we(){this.id=0;this.a=null;this.b=this.contentType=""};function ze(a,b,c,d,e){G.call(this,a);this.c=b;this.a=new Qb(c,d,e);this.w=this.I=this.b=null;this.K=!1;this.g=null;this.l=!1;this.i=null;this.s=!1;this.h=new H;this.j=this.f=!1;this.B=0;this.L=15;this.F=!1}q(ze,G);ze.prototype.G=function(a){null!=a.initialStreamBufferSize&&(this.B=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.L=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.s=Number(a.segmentRequestTimeout))};
ze.prototype.destroy=function(){Ae(this);this.h.destroy();this.b=this.h=null;this.a.destroy();this.v=this.c=this.a=null};k=ze.prototype;k.oa=function(){return this.b};k.cb=function(){return this.I};k.tb=function(a){this.f||a.then(function(){this.f=!0;this.g||Be(this,0)}.bind(this)).catch(function(){});return this.h};k.Ga=function(){return this.j};
k.ra=function(a,b,c){if(a!=this.b){var d=[a.H.create(),a.D.create()];Promise.all(d).then(I(this,function(d){if(this.c){var f=this.b;this.b=a;this.I=d[0];this.w=d[1];this.K=!0;this.l||(f?b&&Ce(this,!0,c):Be(this,0))}})).catch(I(this,function(a){"aborted"!=a.type&&(this.f?(a=B(a),this.dispatchEvent(a)):this.h.reject(a))}))}};k.lb=function(){return Ce(this,!1)};
function Ce(a,b,c){a.b&&!a.l&&(a.l=!0,Ae(a),Sb(a.a).then(I(a,function(){var a=this.c.currentTime;if(!b&&0<Tb(this.a,a)&&0<=Yb(this.a.b,a))return Promise.resolve();if(c)return ac(this.a,this.c.currentTime+c);this.F=!0;return $b(this.a)})).then(I(a,function(){this.l=!1;Be(this,0)})).catch(I(a,function(a){this.l=!1;this.f?(a=B(a),this.dispatchEvent(a)):this.h.reject(a)})))}k.mb=function(a){return 0<Tb(this.a,a)&&0<=Yb(this.a.b,a)};k.va=function(){};k.Da=function(){return!0};
k.Ob=function(){if(this.s&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.j)a=1<this.a.c.buffered.length?!0:!1;if(a)Ce(this,!0);else{this.g=null;a=this.b;var b=this.I,c=this.c.currentTime;Tb(this.a,this.s?c:c+(this.i||0))>=(this.s?Math.max(this.B,this.L):this.B)?(De(this),Be(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=Ee(this,c,b))?(b=Ub(this.a,b,a.c,this.w),this.w=null,this.K&&(this.K=!1,Fe(this,a)),this.j=!1,b.then(I(this,function(a){null==this.i&&(this.i=a);this.F&&0<Tb(this.a,c)&&(this.F=
!1,this.c.currentTime+=.001);Be(this,0)})).catch(I(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.bc.status)&&this.b&&Be(this,5E3);a=B(a);this.dispatchEvent(a)}}))):(De(this),this.f&&!this.j&&(this.j=!0,Ge(this)),Be(this,1E3))}}};function Ee(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.a?c.la(a.a):null:c.la(b)||(c.length()?c.A():null)}
function De(a){if(!a.s&&null!=a.i){a.s=!0;var b=a.a,c=a.i,d=c-b.w;0!=d&&(b.b=Ud(b.b,d),b.w=c);a.h.resolve(a.i)}}function Fe(a,b){var c;c=b.a.split("/")[0];c=A({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function Ge(a){var b=A({type:"ended"});a.dispatchEvent(b)}function Be(a,b){a.g=window.setTimeout(a.Ob.bind(a),b)}function Ae(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function He(a){this.b=a;this.a=null}He.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)};He.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new Pd(0,null,this.b);this.a=new S([a]);return Promise.resolve(this.a)};function Ie(a,b){G.call(this,a);this.b=b;this.g=!0;this.h=this.f=null;this.c=new H;this.a=null}q(Ie,G);Ie.prototype.G=function(){};Ie.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.v=this.b=this.f=this.h=this.a=this.c=null};k=Ie.prototype;k.oa=function(){return this.f};k.cb=function(){return this.h};k.tb=function(){return this.c};k.Ga=function(){return!0};
k.ra=function(a){a.H.create().then(I(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a;this.h=b;b=T(b).url.b[0].toString();var d=this.Da();this.a&&(this.va(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.va(d);b=A({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.c.resolve(0)}}))};k.lb=function(){};
k.mb=function(){return!0};k.va=function(a){this.g=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};k.Da=function(){this.a&&(this.g="showing"==this.a.track.mode);return this.g};function Je(){}
Je.prototype.parse=function(a,b,c,d){var e=null;try{var f;var g=new Va(b);if(440786851!=Xa(g).id)f=null;else{var h=Xa(g);if(408125543!=h.id)f=null;else{var l=h.a.byteOffset,m;var n=new Va(h.a);for(b=null;Ra(n.a);){var t=Xa(n);if(357149030==t.id){b=t;break}}if(b){for(var C=new Va(b.a),n=1E6;Ra(C.a);){var u=Xa(C);if(2807729==u.id){n=ab(u);break}}m=n/1E9}else m=null;f=m?{Ub:l,Zb:m}:null}}if(f){var v=Xa(new Va(a));if(475249515!=v.id)e=null;else{var va=f.Ub,Ob=f.Zb;a=[];var de=new Va(v.a);for(f=v=-1;Ra(de.a);){var ee=
Xa(de);if(187==ee.id){var Ia;var fe=new Va(ee.a),ge=Xa(fe);if(179!=ge.id)Ia=null;else{var zf=ab(ge),he=Xa(fe);if(183!=he.id)Ia=null;else{for(var ie=new Va(he.a),l=0;Ra(ie.a);){var je=Xa(ie);if(241==je.id){l=ab(je);break}}Ia={ac:zf,Tb:l}}}if(Ia){var ke=Ob*Ia.ac,le=va+Ia.Tb;if(0<=v){var Sc=new J(d,c,f,le-1);a.push(new Pd(v,ke,Sc))}v=ke;f=le}}}0<=v&&(Sc=new J(d,c,f,null),a.push(new Pd(v,null,Sc)));e=a}}else e=null}catch(me){if(!(me instanceof RangeError))throw me;}return e};function Ke(a,b,c,d,e,f,g){this.g=a;this.i=b;this.f=c;this.a=d;this.c=e;this.j=f;this.b=null;this.h=g}Ke.prototype.destroy=function(){this.h=this.i=this.g=null;this.a.g();this.a=null;this.c&&(this.c.g(),this.c=null);this.b=null};
Ke.prototype.create=function(){if(this.b)return this.b;var a=[Xb(this.a)];"webm"==this.f&&a.push(Xb(this.c));return this.b=Promise.all(a).then(I(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.f?(d=new Vd,d=d.parse(new DataView(c),this.a.f,this.a.b,this.h)):"webm"==this.f&&(d=new Je,d=d.parse(new DataView(c),new DataView(a),this.a.b,this.h));if(!d)return c=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),c.type="stream",Promise.reject(c);
var e;"dynamic"==this.g.type?e=new U(d,this.g,this.i,this.j):e=new S(d);return Promise.resolve(e)}))};function Le(a){this.a=a}
function Me(a,b,c){for(var d=x()/1E3,e=0;e<b.a.length;++e)for(var f=b.a[e],g=0;g<f.b.length;++g){var h=f.b[g];if("text"!=h.contentType)for(var l=0;l<h.a.length;++l){var m=h.a[l],n=0,n=n+(m.g?1:0),n=n+(m.b?1:0),n=n+(m.a?1:0);0==n?(h.a.splice(l,1),--l):1!=n&&(m.g?(m.b=null,m.a=null):m.b&&(m.a=null))}}Ne(b);for(e=0;e<b.a.length;++e)for(f=b.a[e],g=0;g<f.b.length;++g){l=h=f.b[g];m=null;for(n=0;n<l.a.length;++n){var t=l.a[n].f||"";m?t!=m&&(l.a.splice(n,1),--n):m=t}0==h.a.length&&(f.b.splice(g,1),--g)}"dynamic"==
b.type&&null==b.c&&(b.c=d);e=new ye;"dynamic"==b.type&&(e.b=!0,e.f=b.g,e.g=new J(c,b.j||b.url),e.h=b.c);e.c=b.h||5;for(f=0;f<b.a.length;++f){g=b.a[f];if(null==g.start)break;g=Oe(a,b,g,d,c);e.a.push(g)}return e}
function Ne(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.b=null);b(a.b)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.b);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.b};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.b)||(e=a.a[a.a.length-1],d?a.b=c:b(e.start)&&b(e.a)?a.b=e.start+e.a:"dynamic"!=a.type&&
(a.b=c))}}function Oe(a,b,c,d,e){var f=new xe;f.id=c.id;f.start=c.start;f.b=c.a;var g=new D;c.b.forEach(function(a){g.push(a.contentType||"",a)});for(var h=rb(g),l=0;l<h.length;++l){var m=new D;g.get(h[l]).forEach(function(a){m.push(a.group,a)});for(var n=rb(m),t=0;t<n.length;++t){var C=new D;m.get(n[t]).forEach(function(a){C.push(a.lang,a)});for(var u=rb(C),v=0;v<u.length;++v){var va=C.get(u[v]),va=Pe(a,b,c,va,d,e);f.a.push(va)}}}return f}
function Pe(a,b,c,d,e,f){ba(d.every(function(a){return a.group==d[0].group&&(a.lang||"")==(d[0].lang||"")&&(a.contentType||"")==(d[0].contentType||"")}));var g=new te,h=d.filter(function(a){return null!=a.id});h.length==d.length&&(g.id=h.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));g.lang=d[0].lang||"";g.contentType=d[0].contentType||"";g.b=d.some(function(a){return a.c});for(var h={},l=0;l<d.length;++l)for(var m=d[l],n=0;n<m.a.length;++n){var t=m.a[n],C=Qe(a,t),u=g.a.slice(0);
Re(C,u);0==u.length&&0<g.a.length||!(t=Se(b,c,t,e,f))||(g.m.push(t),g.a=u,h[t.C]=m)}if(g.a.some(function(a){return""==a.a}))return g.m.forEach(function(a){a.N=!0}),g;a=Te(d);for(l=0;l<g.m.length;++l)t=g.m[l],m=h[t.C],m==a&&(t.N=!0);return g}function Te(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function Re(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.h==g.h&&f.i==g.i&&f.g==g.g&&f.v==g.v&&f.f==g.f&&f.j==g.j&&Za(f.c,g.c)){d=!0;ic(b[c],a[e].b);break}}d||(b.splice(c,1),--c)}}function Qe(a,b){var c=[];if(0==b.c.length)c.push(new gc);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,Ue(a,b.c[d]));return c}
function Ue(a,b){var c=[];if(2!=a.a.length)return[];var d=a.a(b.c||"",b.f);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f=hc(d[e]);0==f.b.length&&b.a&&b.a.psshBox&&ic(f,[{initData:b.a.psshBox,initDataType:"cenc"}]);c.push(f)}return c}
function Se(a,b,c,d,e){if(!c.u||0===c.u.length)return null;var f=null,g=1,h=0;if(c.g)f=c.f.split("/")[1],"mp4"!=f&&"webm"!=f?f=null:(g=c.g,"webm"!=f||g.c?g.a||g.b&&g.b.a?(h=g.b,h||(h=new kd,h.url=c.u,h.a=g.a?g.a.clone():null),h=Ve(h,e),g=g.c?Ve(g.c,e):null,a=new Ke(a,b,f,h,g,d,e),b=new Sd(g),d=new qe,d.H=a,d.D=b,f=d):f=null:f=null),g=c.g.g,h=c.g.f;else if(c.b)f=c.b,!f.b&&!f.c&&1<f.a.length?f=null:f.b||b.a||f.c||1!=f.a.length?f.c&&0===f.c.a.length?f=null:(f=f.h?Ve(f.h,e):null,a=new ne(a,b,c,d,e),b=
new Sd(f),d=new qe,d.H=a,d.D=b,f=d):f=null,g=c.b.f,h=c.b.g;else if(c.a){a:if(f=c.a,g=0+(f.f?1:0),g+=f.c?1:0,g+=f.b?1:0,0==g?g=!1:(1!=g&&(f.f?(f.c=null,f.b=null):f.c&&(f.b=null)),g=!0),g){g=null;if(f.g&&(g=(f=c.a.g)?We(c,f,ld):null,!g)){f=null;break a}f=g?Ve(g,e):null;g=c.a;g.f?(g=c.f.split("/")[1],"mp4"!=g&&"webm"!=g?a=null:"webm"!=g||f?Od(e,c,1,0)?(h=(h=c.a.f)?We(c,h,kd):null)?(h=Ve(h,e),a=new Ke(a,b,g,h,f,d,e)):a=null:a=null:a=null):a=g.h?g.c?new oe(a,b,c,d,e):g.b?"dynamic"!=a.type&&null==b.a?null:
new ce(a,b,c,d,e):null:null;a?(b=new Sd(f),d=new qe,d.H=a,d.D=b,f=d):f=null}else f=null;g=c.a.a;h=c.a.i}else"text"==c.f.split("/")[0]&&(f=new qe,f.H=new He(new J(e,c.u)));if(!f)return null;f.id=c.id;h&&(f.c=-1*h/g);f.bandwidth=c.bandwidth;f.width=c.width;f.height=c.height;f.a=c.f||"";f.b=c.h||"";for(a=0;a<c.c.length;++a)b=c.c[a],b.b&&f.f.push(b.b);return f}function We(a,b,c){b=Qd(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=Jd(a.u,b);return c}
function Ve(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.na,e=a.a.end);return new J(b,c,d,e)};function Xe(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function Ye(a,b){var c=new Ze(b);a.streamHistory.push(new $e(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function Ze(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function $e(a){this.timestamp=x()/1E3;this.value=a};function af(a,b){Bb.call(this,"readwrite",b);this.j=a;this.b=0}q(af,Bb);
function bf(a,b,c,d,e){for(var f=[],g=[],h=0,l=0,m=[],n=b.map(function(a){return a.H.create()}),n=Promise.all(n),t=b.map(function(a){return a.D.create()}),t=Promise.all(t),n=Promise.all([n,t]).then(function(a){f=a[0];g=a[1];h=f.reduce(function(a,b){return a+b.length()},0)}),t=0;t<b.length;++t)n=n.then(function(a){return cf(this,b[a],f[a],g[a],h,l)}.bind(a,t)),n=n.then(function(a,b){l+=f[a].length();m.push(b)}.bind(a,t));return n.then(I(a,function(){return df(Ib(this))})).then(I(a,function(a){var b=
new H;c=Na(c);var f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.a,license_server:e.h,with_credentials:e.i,distinctive_identifier:e.g,audio_robustness:e.f,video_robustness:e.j},g=Ib(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}function ef(a,b){return Jb(Ib(a),b).then(I(a,function(a){var d=[],e;for(e in a.stream_ids)d.push(ff(this,a.stream_ids[e]));a=Ib(this);d.push(a.delete(b));return Promise.all(d)}))}
function cf(a,b,c,d,e,f){var g=[df(Hb(a)),df(Fb(a).index("stream"))],g=Promise.all(g).then(I(a,function(a){return{qa:Math.max(a[0],a[1]),ja:new ArrayBuffer(0),Ja:0,o:[],Ca:null,$b:e,kb:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}function df(a){var b=new H,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}
af.prototype.g=function(a,b,c){var d=new H;a={stream_id:c.qa,mime_type:a.a,codecs:a.b,init_segment:b,references:c.o};var e=Hb(this).put(a);e.onsuccess=function(){d.resolve(c.qa)};e.onerror=function(){d.reject(e.error)};return d};af.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=d==a.length()-1,f=this.c.bind(this,e,b,f),c=c.then(this.i.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(I(this,function(a){ff(this,b.qa);return Promise.reject(a)}))};
af.prototype.c=function(a,b,c,d){var e=new H;0==b.ja.byteLength&&(b.Ca=a);b.ja=gf(b.ja,d);b.kb++;var f=A({type:"progress",detail:b.kb/b.$b*100,bubbles:!0});if(1048576<=b.ja.byteLength||c){c={stream_id:b.qa,segment_id:b.Ja,content:b.ja};var g=Fb(this).put(c);b.o.push({start_time:b.Ca.b,start_byte:b.Ca.url.f,end_time:a.a,url:"idb://"+b.qa+"/"+b.Ja});b.Ja++;b.ja=new ArrayBuffer(0);g.onerror=function(){e.reject(g.error)};g.onsuccess=I(this,function(){this.dispatchEvent(f);e.resolve()})}else this.dispatchEvent(f),
e.resolve();return e};function gf(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}af.prototype.i=function(a){var b=new Wb;b.c=1E3*this.b;return Xb(a.url,b,this.j)};
function ff(a,b){var c=new H,d=Hb(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=Fb(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c};function hf(a,b,c,d,e,f){this.b=new J(null,[new K(a)]);this.a=new Wb;this.a.body=b;this.a.method=c;this.a.a=3;this.a.j=d;this.a.c=1E3*(null!=f?f:0);a=e||{};for(var g in a)this.a.b[g]=a[g]}function jf(a){return Xb(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function kf(a,b,c){G.call(this,a);this.h=b;this.b=c;this.a=this.i=null;this.l=new E;this.c=[];this.f=[];this.s=0;this.g=new H;this.j=null;this.w=0}q(kf,G);kf.prototype.destroy=function(){this.v=null;for(var a=0;a<this.f.length;++a)this.f[a].close().catch(function(){});this.f=[];this.c=this.a=this.i=null;this.g.destroy();this.g=null;this.l.destroy();this.l=null;this.j&&(window.clearTimeout(this.j),this.j=null);this.h=this.b=null};
kf.prototype.initialize=function(){for(var a=new D,b=this.b.bb(),c=0;c<b.length;++c){var d=b[c];d.a.a||d.b&&!lf(d.b)||a.push(d.contentType,d)}for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.g?"required":"optional",persistentState:h.v||this.b.ha()?"required":"optional",sessionTypes:[this.b.ha()?"persistent-license":"temporary"]},
c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var l;"audio"==f.contentType?l=f.a.f:"video"==f.contentType&&(l=f.a.j);h[g].push({contentType:f.b,robustness:l})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return this.b.Ka(a),this.g.resolve(),Promise.resolve();l=new H;c=mf(this,c,l);c=c.then(this.ub.bind(this,b,a));c=c.then(this.Vb.bind(this));l.reject(null);return c};
function nf(a,b){null==a.j&&(a.j=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.g.reject(a)}.bind(a),b));return a.g}function of(a){return Promise.all(a.f.map(function(a){return a.remove()}))}
function mf(a,b,c){for(var d in b)c=c.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,d,b[d]));a.b.ha()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c}k=kf.prototype;
k.ub=function(a,b,c){if(!this.h)return pf();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var l=e[h+"Capabilities"];if(l&&l.length){for(var l=l[0],m=[],n={},t=0;t<a.length;++t){var C=a[t];if(C.a.a==d&&C.b==l.contentType&&!(C.id in n)){m.push(C);n[C.id]=!0;var u;if(this.a){u=this.a;var C=C.a,v=new gc;v.a=u.a;v.h=u.h;v.i=u.i;v.l=u.l;v.s=u.s;v.g=u.g;v.v=u.v;v.f=u.f;v.j=u.j;v.c=u.c?new Uint8Array(u.c.buffer):null;ic(v,u.b);ic(v,
C.b);u=v}else u=C.a;this.a=u}}b.set(h,m)}}}this.b.Ka(b);return c.createMediaKeys()};
k.Vb=function(a){if(!this.h)return pf();this.i=a;return this.h.setMediaKeys(this.i).then(I(this,function(){return this.h?this.a.c?this.i.setServerCertificate(this.a.c):Promise.resolve():pf()})).then(I(this,function(){if(!this.h)return pf();if(0<this.b.ua().length)qf(this);else{for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.eb({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&F(this.l,this.h,"encrypted",this.eb.bind(this))}}))};
function pf(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}
k.eb=function(a){for(var b=new Uint8Array(a.initData),c=0;c<this.c.length;++c)if(Za(b,this.c[c].data))return;try{var d=rf(this)}catch(e){b=B(e);this.dispatchEvent(b);this.g.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.c.push({data:b,La:d});a.catch(I(this,function(a){if(this.h){for(var b=0;b<this.c.length;++b)if(this.c[b].La==d){this.c.splice(b,1);break}b=B(a);this.dispatchEvent(b);this.g.reject(a)}}));this.f.push(d)};
function qf(a){for(var b=a.b.ua(),c=0;c<b.length;++c){var d=rf(a),e=d.load(b[c]);a.f.push(d);e.then(I(a,function(){this.s++;this.s>=this.f.length&&this.g.resolve()})).catch(I(a,function(a){a=B(a);this.dispatchEvent(a)}))}}
function rf(a){var b=null;if(a.b.ha())try{b=a.i.createSession("persistent-license")}catch(c){throw Error("Persistent licenses are not supported by this key system or platform.");}else b=a.i.createSession();F(a.l,b,"message",a.Kb.bind(a));F(a.l,b,"keystatuseschange",a.zb.bind(a));return b}k.Kb=function(a){sf(this,a.target,this.a,a.message)};
k.zb=function(a){a=a.target;for(var b=a.keyStatuses,c={},d=b.keys(),e=d.next();!e.done;e=d.next()){var f=fc(new Uint8Array(e.value)),e=b.get(e.value);c[f]=e}if(a.expiration<Date.now()){for(b=0;b<this.c.length;++b)if(this.c[b].La==a){this.c.splice(b,1);break}a.close();this.f.splice(this.f.indexOf(a),1)}this.b.fb(c)};
function sf(a,b,c,d){d=tf(c,d);jf(new hf(d.url,d.body,d.method,c.i,d.headers,a.w)).then(I(a,function(a){c.l&&(a=c.l(a));return b.update(a)})).then(I(a,function(){var a=A({type:"sessionReady",detail:b});this.dispatchEvent(a);this.s++;this.s>=this.f.length&&this.g.resolve()})).catch(I(a,function(a){a.La=b;a=B(a);this.dispatchEvent(a)}))}
function tf(a,b){var c={url:a.h,body:b.slice(0),method:"POST",headers:{}};if("com.microsoft.playready"===a.a){for(var d=String.fromCharCode.apply(null,new Uint16Array(c.body)),d=(new DOMParser).parseFromString(d,"application/xml"),e=d.getElementsByTagName("name"),f=d.getElementsByTagName("value"),g=0;g<e.length;g++)c.headers[e[g].childNodes[0].nodeValue]=f[g].childNodes[0].nodeValue;c.body=window.atob(d.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue)}if(!a.s)return c;a.s(c);c.url=nb(c,
"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=nb(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=ob(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");return c};function V(a){G.call(this,null);this.a=a;this.b=null;this.f=new E;this.i=this.j=null;this.F=0;this.w=null;this.h=!1;this.g=new Xe;this.c={enableAdaptation:!0,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new ja};this.l=1;this.G=null}q(V,G);p("shaka.player.Player",V);V.version="v1.6.2-13-gf21a725";
V.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function lf(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}V.isTypeSupported=lf;
V.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+oa(a)+" }",0)};V.prototype.destroy=function(){return this.s().then(I(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};V.prototype.destroy=V.prototype.destroy;
V.prototype.s=function(){if(!this.b)return Promise.resolve();this.h&&uf(this);this.a.pause();sb(this.f);vf(this);wf(this);this.j&&(this.j.destroy(),this.j=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.h=!1;this.g=new Xe;return a};V.prototype.unload=V.prototype.s;
V.prototype.ea=function(a){var b=this.s();this.a.autoplay&&(da("load"),F(this.f,this.a,"timeupdate",this.yb.bind(this)));a.T(this.c);a.qb(this.G);this.G=null;b=b.then(I(this,function(){return a.X()}));b.catch(I(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(I(this,function(){if(!this.a)return xf();this.b=a;F(this.f,this.b,"seekrangechanged",this.Ib.bind(this));this.j=new kf(this,this.a,this.b);return this.j.initialize()})).then(I(this,function(){if(!this.a)return xf();F(this.f,
this.a,"error",this.Wb.bind(this));F(this.f,this.a,"playing",this.Gb.bind(this));F(this.f,this.a,"pause",this.Fb.bind(this));return this.b.Wa(this,this.a)})).then(I(this,function(){if(!this.a)return xf();yf(this)})).catch(I(this,function(a){if(!this.a)return xf();if("destroy"!=a.type){var b=B(a);this.dispatchEvent(b)}return this.s().then(function(){return Promise.reject(a)})}))};V.prototype.load=V.prototype.ea;
function xf(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}k=V.prototype;k.yb=function(){ga("load");this.g.playbackLatency=ha("load")/1E3;this.f.sa(this.a,"timeupdate")};k.Wb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(Af[a]||"Unknown playback error."),a.type="playback",a=B(a),this.dispatchEvent(a))}};
k.Gb=function(){da("playing");!this.i&&0>this.l&&(this.a.playbackRate=0,this.B(this.a.currentTime,Date.now(),this.l));this.h&&uf(this)};k.Fb=function(){ga("playing");var a=ha("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}wf(this)};k.Ib=function(a){this.F=a.start};
k.rb=function(){if(!this.a.paused){ga("playing");var a=ha("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;da("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};V.prototype.getStats=V.prototype.rb;V.prototype.da=function(){return this.b?this.b.ma():[]};V.prototype.getVideoTracks=V.prototype.da;V.prototype.Y=function(){return this.b?this.b.pa():[]};
V.prototype.getAudioTracks=V.prototype.Y;V.prototype.$=function(){return this.b?this.b.Oa():[]};V.prototype.getTextTracks=V.prototype.$;V.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};V.prototype.selectVideoTrack=V.prototype.selectVideoTrack;V.prototype.M=function(a,b,c){return this.b?this.b.ob(a,void 0==b?!0:b,c):!1};V.prototype.selectAudioTrack=V.prototype.M;V.prototype.fa=function(a){return this.b?this.b.pb(a,!1):!1};
V.prototype.selectTextTrack=V.prototype.fa;V.prototype.V=function(a){this.b&&this.b.Na(a)};V.prototype.enableTextTrack=V.prototype.V;V.prototype.T=function(a){wf(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.B(this.a.currentTime,Date.now(),a));this.l=a};V.prototype.setPlaybackRate=V.prototype.T;V.prototype.K=function(){return this.l};V.prototype.getPlaybackRate=V.prototype.K;V.prototype.R=function(a){this.G=a};V.prototype.setPlaybackStartTime=V.prototype.R;
V.prototype.I=function(){return this.b?this.b.nb():!1};V.prototype.isLive=V.prototype.I;
V.prototype.U=function(a){if(a){var b=kb(a,"enableAdaptation");null!=b&&(this.c.enableAdaptation=b);b=mb(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=mb(a,"liveStreamEndTimeout");null!=b&&(this.c.liveStreamEndTimeout=b);b=mb(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=mb(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=mb(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=nb(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=
b);b=ob(a,"restrictions",ja);null!=b&&(this.c.restrictions=b.clone());a=kb(a,"disableCacheBustingEvenThoughItMayAffectBandwidthEstimation");null!=a&&(Dd=!a);this.b&&this.b.T(this.c)}};V.prototype.configure=V.prototype.U;V.prototype.Z=function(){return this.c};V.prototype.getConfiguration=V.prototype.Z;function wf(a){a.i&&(window.clearTimeout(a.i),a.i=null)}function yf(a){vf(a);a.w=window.setTimeout(a.L.bind(a),100)}function vf(a){a.w&&(window.clearTimeout(a.w),a.w=null)}
V.prototype.B=function(a,b,c){this.i=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.F+(this.I()?1:.05)?this.a.pause():(d=Math.max(this.F,a+d),this.a.currentTime=d,this.i=window.setTimeout(this.B.bind(this,a,b,c),250))};function uf(a){ga("buffering");var b=a.g;b.bufferingTime+=ha("buffering")/1E3;a.h=!1;a.dispatchEvent(A({type:"bufferingEnd"}))}
V.prototype.L=function(){yf(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0),c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;if(this.h){if(c=this.b.ab(),b||a>c)uf(this),this.a.play()}else!this.a.paused&&!b&&.5>a&&(this.h=!0,this.a.pause(),this.g.bufferingHistory.push(x()/1E3),da("buffering"),this.dispatchEvent(A({type:"bufferingStart"})))}};
var Af={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function Bf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.m.length;++g)lf(se(f.m[g]))||(f.m.splice(g,1),--g);0==e.m.length&&(c.a.splice(d,1),--d)}}function Cf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d)c.a[d].m.sort(Df)}function Df(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function Ef(a){this.a=a}Ef.prototype.destroy=function(){this.a.destroy();this.a=null};Ef.prototype.update=function(a){var b=Ff(a),c=Ff(this.a);return Promise.all([b,c]).then(I(this,function(b){var c=b[0];b=b[1];var f=this.a.a;Bf(f);Cf(f);a.f=this.a.f;a.g=this.a.g?this.a.g.clone():null;a.c=this.a.c;f=[];Gf(a,this.a,c,b,f);c=a.a;Bf(c);Cf(c);return Promise.resolve(f)}))};
function Ff(a){function b(a,b){return a.concat(b)}var c=a.a.map(function(a){return a.a}).reduce(b,[]).map(function(a){return a.m}).reduce(b,[]);a=c.map(function(a){return a.H.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].C]=a[f];return Promise.resolve(b)})}
function Gf(a,b,c,d,e){var f=new D;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new D;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=rb(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(Hf(l[0],h[0],c,d,e),l[0].b=h[0].b)}}
function Hf(a,b,c,d,e){var f=new D;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new D;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=rb(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&If(l[0],h[0],c,d,e)}}
function If(a,b,c,d,e){var f=new D;a.m.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new D;b.m.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=rb(f),l=0;l<h.length;++l){var m=h[l];b[m]=m;var n=f.get(m);1<n.length||((m=g.get(m))&&0!=m.length?1==m.length&&(Jf(n[0],m[0],c,d),n[0].D=m[0].D,m[0].D=null,n[0].c=m[0].c):(e.push(n[0]),a.m.splice(a.m.indexOf(n[0]),1)))}h=rb(g);for(l=0;l<h.length;++l)m=h[l],b[m]||(b[m]=m,m=g.get(m),a.m.push(m[0]))}
function Jf(a,b,c,d){a=c[a.C];b=d[b.C];a.length();a.Ha(b)&&a.length()};function W(){this.a=this.b=null;this.f=new E;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}p("shaka.media.SimpleAbrManager",W);W.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};W.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
W.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,F(this.f,this.b,"bandwidth",this.v.bind(this)),F(this.f,this.a,"adaptation",this.j.bind(this)),F(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};W.prototype.enable=function(a){this.i=a};W.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=Kf(this);return a?a.id:null};W.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
W.prototype.v=function(){Date.now()<this.c||this.h()};W.prototype.h=function(){if(this.i){var a=Kf(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};W.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function Kf(a){var b=a.a.ma();if(0==b.length)return null;b.sort(sa);var c;a:{c=a.a.pa();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function Lf(a,b,c){G.call(this,null);this.f=a;this.c=b;this.b=hc(c);this.a=null}q(Lf,G);p("shaka.player.HttpVideoSource",Lf);Lf.prototype.T=function(){};Lf.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null);this.v=this.b=null};k=Lf.prototype;k.Wa=function(a,b){this.v=a;var c=b.mediaKeys;b.src=this.f;c=b.setMediaKeys(c);this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing");return c};k.X=function(){return Promise.resolve()};
k.ma=function(){return[]};k.pa=function(){return[]};k.Oa=function(){return[]};k.ab=function(){return 5};k.bb=function(){var a=new we;a.a=this.b;return[a]};k.Ka=function(){};Lf.prototype.selectVideoTrack=function(){return!1};k=Lf.prototype;k.ob=function(){return!1};k.pb=function(){return!1};k.Na=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")};k.qb=function(){};k.ua=function(){return[]};k.ha=function(){return!1};k.nb=function(){return!1};
k.fb=function(a){for(var b in a){var c=a[b],d=bb[c]||null;if(d){var e=wb(b),d=Error("Key "+e+" is not usable. "+d);d.type="drm";d.code=c;c=B(d);this.dispatchEvent(c)}}};function X(a,b,c){G.call(this,null);this.a=a;this.Z=b;this.i=new E;this.g=new MediaSource;this.f=null;this.da=0;this.b=new D;this.I=c;this.I.initialize(b,this);this.L=!1;this.K="en";this.fa=!1;this.U=null;this.B=new H;this.h=new ja;this.F=null;this.Va=1;this.c={};this.ea=new H;this.Ta=0;this.Ua=15;this.w=null;this.Ra=this.Sa=!1;this.s={};this.$=this.Y=this.V=null;this.G={}}q(X,G);p("shaka.player.StreamVideoSource",X);
X.prototype.T=function(a){null!=a.streamBufferSize&&(this.G.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.G.segmentRequestTimeout=a.segmentRequestTimeout);Mf(this);null!=a.enableAdaptation&&this.I.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.da=Number(a.mpdRequestTimeout));null!=a.liveStreamEndTimeout&&(this.Ua=Number(a.liveStreamEndTimeout));null!=a.preferredLanguage&&(this.K=fb(String(a.preferredLanguage)));null!=a.restrictions&&(this.h=a.restrictions,
this.L&&Nf(this))};X.prototype.destroy=function(){this.B.destroy();this.ea.destroy();this.ea=this.B=null;this.Y&&(window.clearTimeout(this.Y),this.Y=null);this.V&&(window.clearTimeout(this.V),this.V=null);this.s=null;this.i.destroy();this.i=null;jb(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.I.destroy();this.v=this.h=this.U=this.f=this.g=this.Z=this.I=null};k=X.prototype;
k.Wa=function(a,b){if(!this.L){var c=Error("Cannot call attach() right now.");c.type="app";return Promise.reject(c)}this.v=a;this.f=b;this.U=a.rb();F(this.i,this.g,"sourceopen",this.Bb.bind(this));F(this.i,this.Z,"bandwidth",this.Xb.bind(this));this.a.b&&(F(this.i,a,"bufferingStart",this.xb.bind(this)),F(this.i,a,"bufferingEnd",this.wb.bind(this)));c=this.f.mediaKeys;this.f.src=window.URL.createObjectURL(this.g);c=this.f.setMediaKeys(c);return Promise.all([this.B,c])};
k.X=function(){if(this.L){var a=Error("Cannot call load() right now.");a.type="app";return Promise.reject(a)}if(!this.a||0==this.a.a.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.a;Bf(a);Cf(a);if(0==this.a.a.length||0==this.a.a[0].a.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.L=!0;this.G.initialStreamBufferSize=this.a.c;Mf(this);Nf(this);
return Promise.resolve()};k.ib=function(a){var b=Date.now(),c=this.V=null,d=this.a.g;(a?this.gb():this.hb(d)).then(I(this,function(a){c=new Ef(a);return c.update(this.a)})).then(I(this,function(a){c.destroy();c=null;for(var d=0;d<a.length;++d)Of(this,a[d]);this.G.initialStreamBufferSize=this.a.c;Mf(this);Nf(this);0==Object.keys(this.c).length?Pf(this):Qf(this,(Date.now()-b)/1E3)})).catch(I(this,function(a){c&&(c.destroy(),c=null);"aborted"!=a.type&&(a=B(a),this.dispatchEvent(a),this.a&&Qf(this,0))}))};
k.hb=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};k.gb=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};function Qf(a,b){if(null!=a.a.f){var c=Math.max(a.a.f,3),c=Math.max(c-b,0);a.V=window.setTimeout(a.ib.bind(a,!1),1E3*c)}}
function Of(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.oa()==b){var e=a.b.get(b.a.split("/")[0]).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.N&&a.J});if(0==e.length){c=Error("All usable streams have been removed from the manifest.");c.type="app";c=B(c);a.dispatchEvent(c);return}a.s[c].Pa==b&&delete a.s[c];d.ra(e[0],!0);b.destroy()}b.destroy()}
k.ma=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.oa():null)?a.C:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.m.length;++f){var g=e.m[f];if(g.N&&g.J){var h=g.C,g=new ra(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};X.prototype.getVideoTracks=X.prototype.ma;
X.prototype.pa=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.oa():null)?a.C:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.m.length;++g){var h=e.m[g];if(h.N&&h.J){var l=h.C,h=new ia(l,h.bandwidth,f);l==a&&(h.active=!0);b.push(h)}}return b};X.prototype.getAudioTracks=X.prototype.pa;
X.prototype.Oa=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.oa():null,b=b?b.C:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.m.length;++h){var l=f.m[h].C,m=new qa(l,g);l==b&&(m.active=!0,m.enabled=a.Da());c.push(m)}return c};X.prototype.getTextTracks=X.prototype.Oa;X.prototype.ab=function(){return Number(this.G.initialStreamBufferSize)};
X.prototype.bb=function(){var a;if(this.L){a=this.a.a[0];for(var b=[],c=0;c<a.a.length;++c)b.push.apply(b,ve(a.a[c]));a=b}else a=[];return a};
X.prototype.Ka=function(a){if(this.L){for(var b={},c=this.a.a[0],d=0;d<c.a.length;++d){var e=c.a[d];b[e.C]=e}this.b.a={};c=rb(a);for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.b.push(e,b[g])}else if("audio"==e)for(var g=f[0].b.split(";")[0],h=0;h<f.length;++h){var l=f[h];l.b.split(";")[0]==g&&this.b.push(e,b[l.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.b.push(e,b[g])}this.fa=!0;if(a=this.b.get("audio"))Rf(this,a),this.b.set("audio",a),a=a[0].lang||this.K,eb(2,
this.K,a)&&(this.fa=!1);if(a=this.b.get("text"))Rf(this,a),this.b.set("text",a),a=a[0].lang||this.K,eb(2,this.K,a)||(this.fa=!1)}};X.prototype.selectVideoTrack=function(a,b,c){return Sf(this,"video",a,b,c)};k=X.prototype;k.ob=function(a,b,c){return Sf(this,"audio",a,b,c)};k.pb=function(a,b){return Sf(this,"text",a,b)};k.Na=function(a){var b=this.c.text;b&&b.va(a)};k.qb=function(a){this.$=a};
function Nf(a){if(a.h){for(var b=!1,c=0;c<a.a.a.length;++c)for(var d=a.a.a[c],e=0;e<d.a.length;++e){var f=d.a[e];if("video"==f.contentType)for(var g=0;g<f.m.length;++g){var h=f.m[g],l=h.J;h.J=!0;a.h.maxWidth&&h.width>a.h.maxWidth&&(h.J=!1);a.h.maxHeight&&h.height>a.h.maxHeight&&(h.J=!1);a.h.minHeight&&h.height<a.h.minHeight&&(h.J=!1);a.h.maxBandwidth&&h.bandwidth>a.h.maxBandwidth&&(h.J=!1);a.h.minBandwidth&&h.bandwidth<a.h.minBandwidth&&(h.J=!1);l!=h.J&&(b=!0)}}0!=pb(a.b).length&&b&&(Tf(a),0<a.ma().length||
(b=Error("The application has restricted all video tracks!"),b.type="app",b=B(b),a.dispatchEvent(b)))}}k.ua=function(){return[]};k.ha=function(){return!1};k.nb=function(){return this.a?this.a.b:!1};
k.fb=function(a){for(var b,c=!1,d=new D,e=pb(this.b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.m.length;++h){var l=g.m[h];l.f.forEach(function(a){d.push(a,l)})}for(b in a)if(e=bb[a[b]]||null,g=d.get(b))for(f=0;f<g.length;++f)l=g[f],h=l.N,l.N=!e,h!=l.N&&(c=!0);else wb(b);c&&(Tf(this),b=this.pa(),a=this.ma(),b=this.b.a.hasOwnProperty("audio")&&0==b.length,a=this.b.a.hasOwnProperty("video")&&0==a.length,b||a)&&(a=Error("The key system has restricted all "+(b&&a?"audio and video tracks.":b?"audio tracks.":
"video tracks.")),a.type="drm",a=B(a),this.dispatchEvent(a))};function Tf(a){var b=A({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}function Sf(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],l=0;l<h.m.length;++l){var m=h.m[l];if(m.C==c){if(!m.N||!m.J)return!1;if("text"!=b&&!a.Ra)return c=a.s[b],a.s[b]={Pa:m,Xa:null!=c&&c.Xa||d,Ya:null!=c&&c.Ya||e},!0;Ye(a.U,m);a.c[b].ra(m,d,e);return!0}}return!1}
function Rf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(eb(c,a.K,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}k.Bb=function(){this.i.sa(this.g,"sourceopen");Pf(this).then(I(this,function(){this.B&&this.B.resolve()})).catch(I(this,function(a){this.B&&this.B.reject(a)}))};
function Pf(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=Uf(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=jb(f).map(function(a){return a.H.create()});return Promise.all(b).then(I(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=Vf(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!Wf(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.I.start();Xf(this,f,a);return Promise.resolve()})).catch(I(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.b?(x()<this.a.h?(a=Math.max(this.a.h-Date.now()/1E3,3),this.V=window.setTimeout(this.ib.bind(this,
!0),1E3*a)):Qf(this,0),Promise.resolve()):Promise.reject(a)}))}function Uf(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.I.getInitialVideoTrackId();if(null==g)continue;f=e.m.filter(function(a){return a.C==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.m.filter(function(a){return a.N&&a.J});if(0==f.length)continue;f=e.m[Math.floor(f.length/2)]}else 0<e.m.length&&(f=e.m[0]);c[e.contentType]=f}return c}
function Wf(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new Ie(a,a.f):Yf(a,e);if(!e)return jb(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function Yf(a,b){var c=new ze(a,a.f,a.g,se(b),a.Z);c.G(a.G);return c}
function Xf(a,b,c){a.Va=a.f.playbackRate;a.f.playbackRate=0;Zf(a,c);var d;a.$&&a.$<=c.end&&a.$>=c.start?d=a.$:a.a.b?(d=c.end,a.Sa=!0):d=c.start;F(a.i,a.f,"seeking",a.Jb.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.F=d);$f(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.tb(a.ea));F(a.i,d,"ended",a.Lb.bind(a));var f=b[e];Ye(a.U,f);d.ra(f,!1)}Promise.all(c).then(a.vb.bind(a)).catch(I(a,function(a){"destroy"!=a.type&&(a=B(a),this.dispatchEvent(a))}));a.Na(a.fa)}
k.vb=function(a){ba(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=ag(this);for(d=0;d<a.length;++d)a[d].ka(c);bg(this,a,c);d=pb(this.b).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.H.create()];a.D&&b.push(a.D.create());return Promise.all(b)});Promise.all(d).then(I(this,function(a){for(var b=0;b<a.length;++b)a[b][0].ka(c);this.Ra=
!0;for(var d in this.s)a=this.s[d],b=this.c[d],Ye(this.U,a.Pa),b.ra(a.Pa,a.Xa,a.Ya);this.s={}})).catch(I(this,function(a){"aborted"!=a.type&&(a=B(a),this.dispatchEvent(a))}))};function bg(a,b,c){if(b=Vf(a,b))Zf(a,b),$f(a,b.start,b.end);0!=c&&(c=a.f.currentTime+c,a.f.currentTime=c,a.F=c);a.Sa&&b&&(a.f.currentTime=b.end);a.f.playbackRate=a.Va;a.a.b&&null!=a.a.f&&Qf(a,0);cg(a);a.ea.resolve()}
function Zf(a,b){if(a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}k.Nb=function(){this.Y=null;cg(this);var a=Vf(this,ag(this));a&&(this.a.b&&this.Ta!=a.A&&(this.Ta=a.A,null!=this.w&&(window.clearTimeout(this.w),this.w=null)),$f(this,a.start,a.end),this.f.paused||dg(this,this.f.currentTime,a.start,a.end))};
function $f(a,b,c){b=A({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}k.Jb=function(){var a=this.f.currentTime;if(null!=this.F){if(a>=this.F-.01&&a<=this.F+.01){this.F=null;return}this.F=null}var b=Vf(this,ag(this));if(b){var c=b.end;(b=dg(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.c)this.c[d].lb()}};
function dg(a,b,c,d){if(b>=c-.01)return!1;b=0;if(a.a.b){b=.5;for(var e in a.c)if(!a.c[e].mb(c+b)){b=a.a.c;break}}a.f.currentTime=Math.min(c+b,d);return!0}k.Lb=function(){if(!this.a.b){for(var a in this.c)if(!this.c[a].Ga())return;this.$a()}};k.xb=function(){jb(this.c).every(function(a){return a.Ga()})&&(this.w=window.setTimeout(this.$a.bind(this),1E3*this.Ua))};k.wb=function(){null!=this.w&&(window.clearTimeout(this.w),this.w=null)};
k.Xb=function(){var a=this.U,b=this.Z.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new $e(b))};k.$a=function(){this.w=null;this.g.endOfStream()};function ag(a){return jb(a.c).map(function(a){return a.cb()}).filter(function(a){return null!=a})}
function Vf(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,f=0;f<b.length;++f){var g=b[f].Ea(),c=Math.max(c,g.start);null!=g.end&&(d=Math.min(d,g.end));b[f].length()&&(e=Math.min(e,b[f].A().a))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.a[0],d.b)d=(d.start||0)+d.b;else return null;a.a.b&&(d=Math.max(d-a.a.c,c));return c>d?null:{start:c,end:d,A:e}}function cg(a){a.a.b&&(a.Y=window.setTimeout(a.Nb.bind(a),1E3))}function Mf(a){for(var b in a.c)a.c[b].G(a.G)};function Y(a,b,c,d){c||(c=new vb);d||(d=new W);X.call(this,null,c,d);this.za=a;this.l=null;this.M=b;this.R=[];this.ga=[];this.ta=[];this.j=null}q(Y,X);p("shaka.player.DashVideoSource",Y);Y.prototype.Aa=function(a,b,c){this.R.push(a);this.ga.push(b||"");this.ta.push(c||"")};Y.prototype.addExternalCaptions=Y.prototype.Aa;Y.prototype.xa=function(a){this.j=a};Y.prototype.setNetworkCallback=Y.prototype.xa;Y.prototype.destroy=function(){this.l=this.j=this.M=null;X.prototype.destroy.call(this)};
Y.prototype.X=function(){var a=new J(this.j,[new K(this.za)]);return Md(new Ld(a,this.da)).then(I(this,function(a){this.l=a;for(var c=0;c<this.R.length;c++){var d=a,e=this.R[c],f=this.ga[c],g=this.ta[c];if(0!==d.a.length){var h=new ad;h.contentType="text";h.lang=f||"en";h.c=!0;f=new dd;f.bandwidth=0;f.f=g||"text/vtt";f.u=[new K(e)];h.a.push(f);d.a[0].b.push(h);wd(d.a[0])}}this.a=Me(new Le(this.M),a,this.j);return X.prototype.X.call(this)}))};
Y.prototype.hb=function(a){return Md(new Ld(a,this.da)).then(I(this,function(a){this.l=a;a=Me(new Le(this.M),a,this.j);return Promise.resolve(a)}))};Y.prototype.gb=function(){var a=Me(new Le(this.M),this.l,this.j);return Promise.resolve(a)};function Z(a,b,c){b||(b=new vb);c||(c=new W);X.call(this,null,b,c);this.R=a;this.M=[];this.timeoutMs=3E4;this.l={};this.j=this.ga=null}q(Z,X);p("shaka.player.OfflineVideoSource",Z);Z.prototype.T=function(a){null!=a.licenseRequestTimeout&&(this.l.licenseRequestTimeout=a.licenseRequestTimeout);null!=a.segmentRequestTimeout&&(this.l.segmentRequestTimeout=a.segmentRequestTimeout);X.prototype.T.call(this,a)};
p("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new Kb,b=Cb(a).then(function(){return Lb(a)});b.then(function(){Eb(a)}).catch(function(){Eb(a)});return b});
Z.prototype.xa=function(a,b,c,d){var e,f=null,g={},h=[];a=new J(this.ga,[new K(a)]);return Md(new Ld(a,this.da)).then(I(this,function(a){this.a=Me(new Le(c),a,this.ga);if(this.a.b)return a=Error("Unable to store live streams offline."),a.type="app",Promise.reject(a);this.T({preferredLanguage:b});return X.prototype.X.call(this)})).then(I(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.g);e=new kf(null,a,this);null!=this.l.licenseRequestTimeout&&(e.w=Number(this.l.licenseRequestTimeout));
F(this.i,e,"sessionReady",this.ta.bind(this));F(this.i,e,"error",function(a){f=a});return e.initialize()})).then(I(this,function(){for(var a=pb(this.b),b=0;b<a.length;++b)for(var c=a[b],e=0;e<c.m.length;++e){var f=c.m[e];g[f.C]=f}return d()})).then(I(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=g[c];if(d)h.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];h=h.filter(function(a){return 0>e.indexOf(a.a.split("/")[0])?!1:!0});a=h.map(function(a){return a.D.create()});
return Promise.all(a)})).then(I(this,function(a){for(var b=h,c=[],d=0;d<b.length;++d)try{c[d]=this.g.addSourceBuffer(se(b[d]))}catch(e){}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(I(this,function(){return nf(e,this.timeoutMs)})).then(I(this,function(){return f?Promise.reject(f):eg(this,h,e.a,this.a.a[0].b)})).then(I(this,function(a){this.R=a;return f?
(fg(this),Promise.reject(f)):Promise.resolve(a)}))};p("shaka.player.OfflineVideoSource.prototype.store",Z.prototype.xa);Z.prototype.Aa=function(a){this.ga=a};Z.prototype.setNetworkCallback=Z.prototype.Aa;Z.prototype.ta=function(a){this.M.push(a.detail.sessionId)};
function eg(a,b,c,d){var e=new af(a.Z,a);null!=a.l.segmentRequestTimeout&&(e.b=Number(a.l.segmentRequestTimeout));return Cb(e).then(I(a,function(){return bf(e,b,this.M,d,c)})).then(function(a){Eb(e);return Promise.resolve(a)}).catch(function(a){Eb(e);return Promise.reject(a)})}
Z.prototype.X=function(){var a=new Kb,b,c;return Cb(a).then(I(this,function(){return Mb(a,this.R)})).then(I(this,function(d){var e=[];this.M=d.session_ids;b=d.duration;c={keySystem:d.key_system,distinctiveIdentifierRequired:d.distinctive_identifier,persistentStorageRequired:!0,audioRobustness:d.audio_robustness,videoRobustness:d.video_robustness,withCredentials:d.with_credentials,licenseServerUrl:d.license_server};for(var f=0;f<d.stream_ids.length;++f)e.push(Nb(a,d.stream_ids[f]));return Promise.all(e)})).then(I(this,
function(a){var e=b,f=c,g=new ye;g.c=5;for(var h=new xe,l=0;l<a.length;++l){var m=a[l],n=new qe,t=new pe(m.references),C=new Sd(null,m.init_segment);n.H=t;n.D=C;n.a=m.mime_type;n.b=m.codecs;n.N=!0;this.j&&(null!=this.j.licenseServerUrl&&(f.licenseServerUrl=this.j.licenseServerUrl),null!=this.j.withCredentials&&(f.withCredentials=this.j.withCredentials),f.licensePostProcessor=this.j.licensePostProcessor,f.licensePreProcessor=this.j.licensePreProcessor,f.serverCertificate=this.j.serverCertificate);
m=hc(f);t=new te;t.m.push(n);t.a.push(m);t.contentType=n.a.split("/")[0];h.a.push(t);h.b=e}g.a.push(h);this.a=g;return X.prototype.X.call(this)})).then(function(){Eb(a);return Promise.resolve()}).catch(function(b){Eb(a);return Promise.reject(b)})};
Z.prototype.za=function(a,b){a&&(this.j={licenseServerUrl:a.licenseServerUrl,withCredentials:a.withCredentials,serverCertificate:a.serverCertificate,licensePreProcessor:a.licensePreProcessor,licensePostProcessor:a.licensePostProcessor});var c=null;return gg(this).catch(function(a){return b?(c=a,Promise.resolve()):Promise.reject(a)}).then(I(this,function(){return fg(this)})).then(function(){return Promise.resolve(c)})};Z.prototype.deleteGroup=Z.prototype.za;Z.prototype.ua=function(){return this.M};
Z.prototype.ha=function(){return!0};function fg(a){var b=new af(null,null);return Cb(b).then(I(a,function(){return ef(b,this.R)})).then(function(){Eb(b);return Promise.resolve()}).catch(function(a){Eb(b);return Promise.reject(a)})}
function gg(a){var b=document.createElement("video");b.src=window.URL.createObjectURL(a.g);var c=new kf(null,b,a);null!=a.l.licenseRequestTimeout&&(c.w=Number(a.l.licenseRequestTimeout));return a.X().then(function(){return c.initialize()}).then(I(a,function(){return nf(c,this.timeoutMs)})).then(function(){return of(c)}).then(I(a,function(){c.destroy();this.destroy();return Promise.resolve()})).catch(I(a,function(a){c.destroy();this.destroy();return Promise.reject(a)}))};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

