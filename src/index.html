<html>
    <head>
        <meta name="viewport" content="width=device-width">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <link rel="stylesheet" href='./preview.css' />
        <link rel="stylesheet" href='./annotations.css' />
        <script src='https://cdn01.boxcdn.net/polyfills/core-js/2.5.3/core.min.js'></script>
        <script src='./preview.js'></script>
        <script src='./annotations.js'></script>

        <style>
            * {
                box-sizing: border-box;
                font-family: sans-serif;
                margin: 0;
                padding: 0;
            }

            .setters-container {
                display: flex;
                font-size: 75%;
                height: 25vh;
                justify-content: space-around;
                padding: 20px;
            }

            .setters-container button,
            .setters-container input {
                padding: 5px;
            }

            .container {
                text-align: center;
            }

            .container > input {
                text-align: center;
            }

            #preview-container {
                height: 75vh;
                width: 100vw;
            }
        </style>
    </head>

    <body>
        <div class='setters-container'>
                <div class='container' id='token'>
                        <div> Token: <span id='token-display'></span> </div>
                        <input id='token-set' data-testid="token" placeholder='Enter token' />
                        <button onClick="setProperty('token')" data-testid="token-set">Set new token</button>
                </div>

                <div class='container' id='file'>
                        <div> File ID: <span id='fileid-display'></span></div>
                        <input id='fileid-set' placeholder='Enter file ID' data-testid="fileid"/>
                        <button onClick="setProperty('fileid')" data-testid="fileid-set">Set new file ID</button>
                </div>

                <div class='container' id='load'>
                    <button onClick="loadPreview()" data-testid="load-preview">Load Preview</button>
                </div>
        </div>

        <div class='preview-container' data-testid="preview-container"> </div>
        <script>
            var fileIds = ["34159726345",
"392470030308",
"34159724259",
"311996286456",
"311476510592",
"311474309637",
"311477800109",
"311481380669",
"311479333922",
"311473861649",
"311481192521",
"34159728407",
"34159728961",
"290023610462",
"153136033009",
"45565373933",
"286086238178",
"268484296725",
"247460245239",
"34159730267",
"237658884882",
"213534037381",
"170784267352",
"35085746199",
"45565364609",
"53998336353",
"41362455574",
"109470485125",
"109470476859",
"41363192886",
"107402701613",
"96511517858",
"94124469475",
"44702126425",
"34159723029",
"53998382761",
"49353297058",
"45565574473",
"34159721191",
"45565489733",
"45565488677",
"45565487713",
"34159726871",
"41363727334",
"34159729669",
"34159720457",
"45565375029",
"41362267026",
"45565362113",
"41362357606",
"34159727301",
"45565293057",
"44906361657",
"43428508477",
"34159730941"];

            function setProperty(selector) {
                // Get new value, fallback to local storage
                var inputValue = document.querySelector('#' + selector + '-set')
                value = inputValue && inputValue.value || localStorage.getItem(selector);


                if (!value) {
                    return;
                }

                // Set it for display purposes
                var displayElement = document.querySelector('#' + selector + '-display');
                displayElement.textContent = value;

                // Cache it in local storage
                localStorage.setItem(selector, value)
            }

            function loadPreview(options) {
                var token = localStorage.getItem('token');
                var fileid = localStorage.getItem('fileid');

                if ( !token || !fileid) {
                    return;
                }

                /* global Box */
                var preview = new Box.Preview();

                var previewOptions = options || {};
                previewOptions.container = '.preview-container';
                previewOptions.enableThumbnailsSidebar = true;

                preview.show(fileid, token, previewOptions);
            }

            // Try to load all properties from storage on page load
            setProperty('token');
            setProperty('fileid');
            loadPreview();
        </script>
    </body>
</html>
